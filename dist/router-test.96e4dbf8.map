{"version":3,"sources":["../src/lib/directive.ts","../src/lib/dom.ts","../src/lib/part.ts","../src/lib/template.ts","../src/lib/template-instance.ts","../src/lib/template-result.ts","../src/lib/parts.ts","../src/lib/default-template-processor.ts","../src/lib/template-factory.ts","../src/lib/render.ts","src/lit-html.ts","../../lib/haunted-builds/index-w-microtask.js","../router-test/use-disconnected.ts","../router-test/use-trigger-update.ts","../../node_modules/router5/node_modules/symbol-observable/es/ponyfill.js","../../node_modules/router5/node_modules/symbol-observable/es/index.js","../../node_modules/search-params/dist/cjs/index.js","../../node_modules/path-parser/dist/es/path-parser.js","../../node_modules/route-node/dist/es/route-node.js","../../node_modules/router5-transition-path/dist/index.es.js","../../node_modules/router5/dist/index.es.js","../../node_modules/router5-plugin-browser/dist/index.es.js","../router-test/use-router.ts","../router-test/child-one.ts","../router-test/child-two.ts","../router-test/router-test.ts"],"names":["current","symbolFor","Symbol","for","str","phaseSymbol","hookSymbol","updateSymbol","commitSymbol","effectsSymbol","contextSymbol","contextEvent","currentId","setCurrent","element","clear","notify","id","defer","Promise","resolve","then","bind","setTimeout","scheduler","tasks","runTasks","t","i","len","length","task","push","read","write","Container","renderer","frag","host","Map","_updateQueued","result","handlePhase","phase","arg","commit","render","runEffects","args","apply","call","symbol","effects","forEach","hook","teardown","toCamelCase","val","indexOf","toLowerCase","split","reduce","out","part","charAt","toUpperCase","slice","component","BaseElement","HTMLElement","options","useShadowDOM","Element","_container","attachShadow","mode","shadowRoot","observedAttributes","update","name","_","newValue","Reflect","set","proto","Proxy","prototype","target","key","value","receiver","desc","enumerable","configurable","writable","reflectiveProp","initialValue","Object","freeze","get","defineProperty","setPrototypeOf","Hook","el","use","hooks","useMemo","fn","values","hasChanged","some","useCallback","inputs","setEffects","cb","useEffect","callback","lastValues","run","_teardown","useState","updater","makeArgs","useReducer","initialState","dispatch","state","reducer","action","DirectiveContainer","virtual","setValue","map","WeakMap","withHooks","factory","cont","setContexts","consumer","useContext","_updater","Context","Error","_subscribe","detail","dispatchEvent","CustomEvent","bubbles","cancelable","composed","unsubscribe","defaultValue","_unsubscribe","createContext","Provider","listeners","eventHandler","event","index","splice","stopPropagation","addEventListener","removeEventListener","_value","Consumer","render$$1","symbolObservablePonyfill","root","observable","self","window","global","module","Function","Path","__assign","assign","s","n","arguments","p","hasOwnProperty","defaultOrConstrained","match","replace","rules","pattern","regex","RegExp","tokenise","tokens","rule","type","otherVal","substr","identity","exists","optTrailingSlash","source","strictTrailingSlash","upToDelimiter","delimiter","test","appendQueryParam","params","param","existingVal","undefined","Array","isArray","concat","path","hasUrlParams","filter","hasSpatParam","hasMatrixParams","hasQueryParams","spatParams","getParams","urlParams","queryParams","r","join","createPath","isQueryParam","opts","_this","urlTest","unexpectedQueryParams","keys","partialTest","delimited","build","ignoreConstraints","ignoreSearch","encodedUrlParams","acc","encode","encodeURI","missingParameters","every","base","searchParams","sparams","paramName","searchPart","predicate","_a","_b","caseSensitive","m","decodeURIComponent","RouteNode","getMetaFromSegments","segments","accName","meta","segment","parser","allParams","buildStateFromMatch","buildPathFromSegments","queryParamsMode","trailingSlashMode","nonSearchParams","_i","segments_1","extraParams","searchParamsObject","segmentPath","absolute","finalPath","getPathFromSegments","getPath","getSearch","matchChildren","nodes","pathSegment","currentMatch","consumedBefore","_c","strongMatching","_d","isRoot","_loop_1","child","remainingPath","children","consumedPath","querystring","remainingQueryParams_1","getNonAbsoluteChildren","nodes_1","state_1","sortChildren","originalChildren","sort","sortPredicate","left","right","leftPath","rightPath","leftSegments","rightSegments","leftParamsCount","rightParamsCount","leftParamLength","rightParamLength","defaultBuildOptions","defaultMatchOptions","childRoutes","parent","finalSort","checkParents","add","sortDescendants","getParentSegments","reverse","setParent","setPath","route","addRouteNode","routeNode","fullName","addNode","routeName","getSegmentsByName","buildPath","buildState","matchPath","getSegmentsMatchingPath","matchedSegments","firstSegmentParams","lastSegment","lastSegmentSlashChild","findSlashChild","names","hasParentsParams","hasParams","findAbsoluteChildren","absoluteChildren","slashChildren","findSegmentByName","routes","matched","filteredRoutes","topLevelNodes","startingNodes","node","finalMatch","transitionPath","nameToIDs","ids","hasMetaParams","extractSegmentParams","toState","fromState","toStateOptions","fromStateIds","toStateIds","maxI","Math","min","reload","pointOfDifference","leftParams","rightParams","different","toDeactivate","toActivate","intersection","shouldUpdateNode","nodeName","fromSate","matching","activatedSegment","createRouter","defaultOptions","autoCleanUp","allowNotFound","rewritePathOnMatch","withOptions","router","routerOptions","getOptions","setOption","option","errorCodes","ROUTER_NOT_STARTED","NO_START_PATH_OR_STATE","ROUTER_ALREADY_STARTED","ROUTE_NOT_FOUND","SAME_STATES","CANNOT_DEACTIVATE","CANNOT_ACTIVATE","TRANSITION_ERR","TRANSITION_CANCELLED","constants","UNKNOWN_ROUTE","ROUTER_START","ROUTER_STOP","TRANSITION_START","TRANSITION_CANCEL","TRANSITION_SUCCESS","TRANSITION_ERROR","withRoutes","forward","fromRoute","toRoute","config","forwardMap","rootNode","onRouteAdded","canActivate","forwardTo","decodeParams","decoders","encodeParams","encoders","defaultParams","canActivateHandler","isActive","strictEquality","ignoreQueryParams","activeState","getState","areStatesEqual","makeState","areStatesDescendants","paramsWithDefault","encodedParams","name_1","decodedParams","forwardState","routeParams","builtPath","setRootPath","rootPath","withDependencies","dependencies","routerDependencies","setDependency","dependencyName","dependency","setDependencies","deps","getDependencies","getInjectables","executeFactory","factoryFunction","withState","stateId","routerState","setState","forceId","makeNotFoundState","state1","state2","getUrlParams","state1Params","state2Params","parentState","childState","eventsMap","onStart","onStop","onTransitionSuccess","onTransitionStart","onTransitionError","onTransitionCancel","withPlugins","routerPlugins","getPlugins","usePlugin","plugins","removePluginFns","plugin","startPlugin","appliedPlugin","removeEventListeners","methodName","Boolean","removeListener","removePlugin","withMiddleware","middlewareFactories","middlewareFunctions","useMiddleware","middlewares","middleware","middlewareFunction","clearMiddleware","getMiddlewareFactories","getMiddlewareFunctions","withObservability","callbacks","subscribe","listener","isObject","finalListener","next","unsubscribeHandler","previousRoute","observer","TypeError","$$observable","invokeEventListeners","eventName","_cb","functions","isCancelled","errorKey","remainingFunctions","isState","obj","processFn","stepFn","errBase","_done","done","err","newState","console","error","mergeStates","res","resVal","stack","promiseError","isMapped","transition","cancelled","completed","getLifecycleFunctions","canDeactivateFunctions","canActivateFunctions","makeError","isUnknownRoute","asyncBase","canDeactivate","forceDeactivate","fnMap","code","cancel","activeSegments_1","clearCanDeactivate","noop","withNavigation","cancelCurrentTransition","navigate","lastArg","isStarted","sameStates","force","skipTransition","transitionToState","redirect","redirected","navigateToDefault","defaultRoute","noop$1","withRouterLifecycle","started","start","startPath","startState","startPathOrState","invokeErrCb","navigateToDefault_1","stop","toFunction","withRouteLifecycle","canDeactivateFactories","canActivateFactories","getLifecycleFactories","canDeactivateHandler","pipe","fns","prev","cloneRouter","clonedRouter","browserPluginFactory","isBrowser","history","getBase","location","pathname","supportsPopStateOnHashChange","navigator","userAgent","pushState","title","replaceState","addPopstateListener","shouldAddHashChangeListener","useHash","getLocation","hash","hashPrefix","safelyEncodePath","search","decodeURI","getHash","browser","safeBrowser","mergeState","preserveHash","removePopStateListener","transitionOptions","routerStart","buildUrl","prefix","updateBrowserState","url","trimmedState","finalState","onPopState","evt","matchUrl","pathParts","urlToPath","replaceHistoryState","lastKnownState","historyState","hasState","statesAreEqual"],"mappings":"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","file":"router-test.96e4dbf8.map","sourceRoot":"../src/_html-web","sourcesContent":["/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {Part} from './part.js';\n\nconst directives = new WeakMap<object, true>();\n\n// tslint:disable-next-line:no-any\nexport type DirectiveFactory = (...args: any[]) => object;\n\nexport type DirectiveFn = (part: Part) => void;\n\n/**\n * Brands a function as a directive so that lit-html will call the function\n * during template rendering, rather than passing as a value.\n *\n * @param f The directive factory function. Must be a function that returns a\n * function of the signature `(part: Part) => void`. The returned function will\n * be called with the part object\n *\n * @example\n *\n * ```\n * import {directive, html} from 'lit-html';\n *\n * const immutable = directive((v) => (part) => {\n *   if (part.value !== v) {\n *     part.setValue(v)\n *   }\n * });\n * ```\n */\n// tslint:disable-next-line:no-any\nexport const directive = <F extends DirectiveFactory>(f: F): F =>\n    ((...args: unknown[]) => {\n      const d = f(...args);\n      directives.set(d, true);\n      return d;\n    }) as F;\n\nexport const isDirective = (o: unknown): o is DirectiveFn => {\n  return typeof o === 'function' && directives.has(o);\n};\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\ninterface MaybePolyfilledCe extends CustomElementRegistry {\n  polyfillWrapFlushCallback?: object;\n}\n\n/**\n * True if the custom elements polyfill is in use.\n */\nexport const isCEPolyfill = window.customElements !== undefined &&\n    (window.customElements as MaybePolyfilledCe).polyfillWrapFlushCallback !==\n        undefined;\n\n/**\n * Reparents nodes, starting from `startNode` (inclusive) to `endNode`\n * (exclusive), into another container (could be the same container), before\n * `beforeNode`. If `beforeNode` is null, it appends the nodes to the\n * container.\n */\nexport const reparentNodes =\n    (container: Node,\n     start: Node|null,\n     end: Node|null = null,\n     before: Node|null = null): void => {\n      let node = start;\n      while (node !== end) {\n        const n = node!.nextSibling;\n        container.insertBefore(node!, before as Node);\n        node = n;\n      }\n    };\n\n/**\n * Removes nodes, starting from `startNode` (inclusive) to `endNode`\n * (exclusive), from `container`.\n */\nexport const removeNodes =\n    (container: Node, startNode: Node|null, endNode: Node|null = null):\n        void => {\n          let node = startNode;\n          while (node !== endNode) {\n            const n = node!.nextSibling;\n            container.removeChild(node!);\n            node = n;\n          }\n        };\n","/**\n * @license\n * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\n/**\n * The Part interface represents a dynamic part of a template instance rendered\n * by lit-html.\n */\nexport interface Part {\n  value: unknown;\n\n  /**\n   * Sets the current part value, but does not write it to the DOM.\n   * @param value The value that will be committed.\n   */\n  setValue(value: unknown): void;\n\n  /**\n   * Commits the current part value, cause it to actually be written to the DOM.\n   */\n  commit(): void;\n}\n\n/**\n * A sentinel value that signals that a value was handled by a directive and\n * should not be written to the DOM.\n */\nexport const noChange: object = {};\n\n/**\n * A sentinel value that signals a NodePart to fully clear its content.\n */\nexport const nothing = {};\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {TemplateResult} from './template-result.js';\n\n/**\n * An expression marker with embedded unique key to avoid collision with\n * possible text in templates.\n */\nexport const marker = `{{lit-${String(Math.random()).slice(2)}}}`;\n\n/**\n * An expression marker used text-positions, multi-binding attributes, and\n * attributes with markup-like text values.\n */\nexport const nodeMarker = `<!--${marker}-->`;\n\nexport const markerRegex = new RegExp(`${marker}|${nodeMarker}`);\n\n/**\n * Suffix appended to all bound attribute names.\n */\nexport const boundAttributeSuffix = '$lit$';\n\n/**\n * An updateable Template that tracks the location of dynamic parts.\n */\nexport class Template {\n  parts: TemplatePart[] = [];\n  element: HTMLTemplateElement;\n\n  constructor(result: TemplateResult, element: HTMLTemplateElement) {\n    this.element = element;\n    let index = -1;\n    let partIndex = 0;\n    const nodesToRemove: Node[] = [];\n    const _prepareTemplate = (template: HTMLTemplateElement) => {\n      const content = template.content;\n      // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be\n      // null\n      const walker = document.createTreeWalker(\n          content,\n          133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */,\n          null,\n          false);\n      // Keeps track of the last index associated with a part. We try to delete\n      // unnecessary nodes, but we never want to associate two different parts\n      // to the same index. They must have a constant node between.\n      let lastPartIndex = 0;\n      while (walker.nextNode()) {\n        index++;\n        const node = walker.currentNode as Element | Comment | Text;\n        if (node.nodeType === 1 /* Node.ELEMENT_NODE */) {\n          if ((node as Element).hasAttributes()) {\n            const attributes = (node as Element).attributes;\n            // Per\n            // https://developer.mozilla.org/en-US/docs/Web/API/NamedNodeMap,\n            // attributes are not guaranteed to be returned in document order.\n            // In particular, Edge/IE can return them out of order, so we cannot\n            // assume a correspondance between part index and attribute index.\n            let count = 0;\n            for (let i = 0; i < attributes.length; i++) {\n              if (attributes[i].value.indexOf(marker) >= 0) {\n                count++;\n              }\n            }\n            while (count-- > 0) {\n              // Get the template literal section leading up to the first\n              // expression in this attribute\n              const stringForPart = result.strings[partIndex];\n              // Find the attribute name\n              const name = lastAttributeNameRegex.exec(stringForPart)![2];\n              // Find the corresponding attribute\n              // All bound attributes have had a suffix added in\n              // TemplateResult#getHTML to opt out of special attribute\n              // handling. To look up the attribute value we also need to add\n              // the suffix.\n              const attributeLookupName =\n                  name.toLowerCase() + boundAttributeSuffix;\n              const attributeValue =\n                  (node as Element).getAttribute(attributeLookupName)!;\n              const strings = attributeValue.split(markerRegex);\n              this.parts.push({type: 'attribute', index, name, strings});\n              (node as Element).removeAttribute(attributeLookupName);\n              partIndex += strings.length - 1;\n            }\n          }\n          if ((node as Element).tagName === 'TEMPLATE') {\n            _prepareTemplate(node as HTMLTemplateElement);\n          }\n        } else if (node.nodeType === 3 /* Node.TEXT_NODE */) {\n          const data = (node as Text).data!;\n          if (data.indexOf(marker) >= 0) {\n            const parent = node.parentNode!;\n            const strings = data.split(markerRegex);\n            const lastIndex = strings.length - 1;\n            // Generate a new text node for each literal section\n            // These nodes are also used as the markers for node parts\n            for (let i = 0; i < lastIndex; i++) {\n              parent.insertBefore(\n                  (strings[i] === '') ? createMarker() :\n                                        document.createTextNode(strings[i]),\n                  node);\n              this.parts.push({type: 'node', index: ++index});\n            }\n            // If there's no text, we must insert a comment to mark our place.\n            // Else, we can trust it will stick around after cloning.\n            if (strings[lastIndex] === '') {\n              parent.insertBefore(createMarker(), node);\n              nodesToRemove.push(node);\n            } else {\n              (node as Text).data = strings[lastIndex];\n            }\n            // We have a part for each match found\n            partIndex += lastIndex;\n          }\n        } else if (node.nodeType === 8 /* Node.COMMENT_NODE */) {\n          if ((node as Comment).data === marker) {\n            const parent = node.parentNode!;\n            // Add a new marker node to be the startNode of the Part if any of\n            // the following are true:\n            //  * We don't have a previousSibling\n            //  * The previousSibling is already the start of a previous part\n            if (node.previousSibling === null || index === lastPartIndex) {\n              index++;\n              parent.insertBefore(createMarker(), node);\n            }\n            lastPartIndex = index;\n            this.parts.push({type: 'node', index});\n            // If we don't have a nextSibling, keep this node so we have an end.\n            // Else, we can remove it to save future costs.\n            if (node.nextSibling === null) {\n              (node as Comment).data = '';\n            } else {\n              nodesToRemove.push(node);\n              index--;\n            }\n            partIndex++;\n          } else {\n            let i = -1;\n            while ((i = (node as Comment).data!.indexOf(marker, i + 1)) !==\n                   -1) {\n              // Comment node has a binding marker inside, make an inactive part\n              // The binding won't work, but subsequent bindings will\n              // TODO (justinfagnani): consider whether it's even worth it to\n              // make bindings in comments work\n              this.parts.push({type: 'node', index: -1});\n            }\n          }\n        }\n      }\n    };\n    _prepareTemplate(element);\n    // Remove text binding nodes after the walk to not disturb the TreeWalker\n    for (const n of nodesToRemove) {\n      n.parentNode!.removeChild(n);\n    }\n  }\n}\n\n/**\n * A placeholder for a dynamic expression in an HTML template.\n *\n * There are two built-in part types: AttributePart and NodePart. NodeParts\n * always represent a single dynamic expression, while AttributeParts may\n * represent as many expressions are contained in the attribute.\n *\n * A Template's parts are mutable, so parts can be replaced or modified\n * (possibly to implement different template semantics). The contract is that\n * parts can only be replaced, not removed, added or reordered, and parts must\n * always consume the correct number of values in their `update()` method.\n *\n * TODO(justinfagnani): That requirement is a little fragile. A\n * TemplateInstance could instead be more careful about which values it gives\n * to Part.update().\n */\nexport type TemplatePart = {\n  type: 'node',\n  index: number\n}|{type: 'attribute', index: number, name: string, strings: string[]};\n\nexport const isTemplatePartActive = (part: TemplatePart) => part.index !== -1;\n\n// Allows `document.createComment('')` to be renamed for a\n// small manual size-savings.\nexport const createMarker = () => document.createComment('');\n\n/**\n * This regex extracts the attribute name preceding an attribute-position\n * expression. It does this by matching the syntax allowed for attributes\n * against the string literal directly preceding the expression, assuming that\n * the expression is in an attribute-value position.\n *\n * See attributes in the HTML spec:\n * https://www.w3.org/TR/html5/syntax.html#attributes-0\n *\n * \"\\0-\\x1F\\x7F-\\x9F\" are Unicode control characters\n *\n * \" \\x09\\x0a\\x0c\\x0d\" are HTML space characters:\n * https://www.w3.org/TR/html5/infrastructure.html#space-character\n *\n * So an attribute is:\n *  * The name: any character except a control character, space character, ('),\n *    (\"), \">\", \"=\", or \"/\"\n *  * Followed by zero or more space characters\n *  * Followed by \"=\"\n *  * Followed by zero or more space characters\n *  * Followed by:\n *    * Any character except space, ('), (\"), \"<\", \">\", \"=\", (`), or\n *    * (\") then any non-(\"), or\n *    * (') then any non-(')\n */\nexport const lastAttributeNameRegex =\n    /([ \\x09\\x0a\\x0c\\x0d])([^\\0-\\x1F\\x7F-\\x9F \\x09\\x0a\\x0c\\x0d\"'>=/]+)([ \\x09\\x0a\\x0c\\x0d]*=[ \\x09\\x0a\\x0c\\x0d]*(?:[^ \\x09\\x0a\\x0c\\x0d\"'`<>=]*|\"[^\"]*|'[^']*))$/;\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {isCEPolyfill} from './dom.js';\nimport {Part} from './part.js';\nimport {RenderOptions} from './render-options.js';\nimport {TemplateProcessor} from './template-processor.js';\nimport {isTemplatePartActive, Template} from './template.js';\n\n/**\n * An instance of a `Template` that can be attached to the DOM and updated\n * with new values.\n */\nexport class TemplateInstance {\n  _parts: Array<Part|undefined> = [];\n  processor: TemplateProcessor;\n  options: RenderOptions;\n  template: Template;\n\n  constructor(\n      template: Template, processor: TemplateProcessor,\n      options: RenderOptions) {\n    this.template = template;\n    this.processor = processor;\n    this.options = options;\n  }\n\n  update(values: unknown[]) {\n    let i = 0;\n    for (const part of this._parts) {\n      if (part !== undefined) {\n        part.setValue(values[i]);\n      }\n      i++;\n    }\n    for (const part of this._parts) {\n      if (part !== undefined) {\n        part.commit();\n      }\n    }\n  }\n\n  _clone(): DocumentFragment {\n    // When using the Custom Elements polyfill, clone the node, rather than\n    // importing it, to keep the fragment in the template's document. This\n    // leaves the fragment inert so custom elements won't upgrade and\n    // potentially modify their contents by creating a polyfilled ShadowRoot\n    // while we traverse the tree.\n    const fragment = isCEPolyfill ?\n        this.template.element.content.cloneNode(true) as DocumentFragment :\n        document.importNode(this.template.element.content, true);\n\n    const parts = this.template.parts;\n    let partIndex = 0;\n    let nodeIndex = 0;\n    const _prepareInstance = (fragment: DocumentFragment) => {\n      // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be\n      // null\n      const walker = document.createTreeWalker(\n          fragment,\n          133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */,\n          null,\n          false);\n      let node = walker.nextNode();\n      // Loop through all the nodes and parts of a template\n      while (partIndex < parts.length && node !== null) {\n        const part = parts[partIndex];\n        // Consecutive Parts may have the same node index, in the case of\n        // multiple bound attributes on an element. So each iteration we either\n        // increment the nodeIndex, if we aren't on a node with a part, or the\n        // partIndex if we are. By not incrementing the nodeIndex when we find a\n        // part, we allow for the next part to be associated with the current\n        // node if neccessasry.\n        if (!isTemplatePartActive(part)) {\n          this._parts.push(undefined);\n          partIndex++;\n        } else if (nodeIndex === part.index) {\n          if (part.type === 'node') {\n            const part = this.processor.handleTextExpression(this.options);\n            part.insertAfterNode(node.previousSibling!);\n            this._parts.push(part);\n          } else {\n            this._parts.push(...this.processor.handleAttributeExpressions(\n                node as Element, part.name, part.strings, this.options));\n          }\n          partIndex++;\n        } else {\n          nodeIndex++;\n          if (node.nodeName === 'TEMPLATE') {\n            _prepareInstance((node as HTMLTemplateElement).content);\n          }\n          node = walker.nextNode();\n        }\n      }\n    };\n    _prepareInstance(fragment);\n    if (isCEPolyfill) {\n      document.adoptNode(fragment);\n      customElements.upgrade(fragment);\n    }\n    return fragment;\n  }\n}\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {reparentNodes} from './dom.js';\nimport {TemplateProcessor} from './template-processor.js';\nimport {boundAttributeSuffix, lastAttributeNameRegex, marker, nodeMarker} from './template.js';\n\n/**\n * The return type of `html`, which holds a Template and the values from\n * interpolated expressions.\n */\nexport class TemplateResult {\n  strings: TemplateStringsArray;\n  values: unknown[];\n  type: string;\n  processor: TemplateProcessor;\n\n  constructor(\n      strings: TemplateStringsArray, values: unknown[], type: string,\n      processor: TemplateProcessor) {\n    this.strings = strings;\n    this.values = values;\n    this.type = type;\n    this.processor = processor;\n  }\n\n  /**\n   * Returns a string of HTML used to create a `<template>` element.\n   */\n  getHTML(): string {\n    const endIndex = this.strings.length - 1;\n    let html = '';\n    for (let i = 0; i < endIndex; i++) {\n      const s = this.strings[i];\n      // This exec() call does two things:\n      // 1) Appends a suffix to the bound attribute name to opt out of special\n      // attribute value parsing that IE11 and Edge do, like for style and\n      // many SVG attributes. The Template class also appends the same suffix\n      // when looking up attributes to create Parts.\n      // 2) Adds an unquoted-attribute-safe marker for the first expression in\n      // an attribute. Subsequent attribute expressions will use node markers,\n      // and this is safe since attributes with multiple expressions are\n      // guaranteed to be quoted.\n      const match = lastAttributeNameRegex.exec(s);\n      if (match) {\n        // We're starting a new bound attribute.\n        // Add the safe attribute suffix, and use unquoted-attribute-safe\n        // marker.\n        html += s.substr(0, match.index) + match[1] + match[2] +\n            boundAttributeSuffix + match[3] + marker;\n      } else {\n        // We're either in a bound node, or trailing bound attribute.\n        // Either way, nodeMarker is safe to use.\n        html += s + nodeMarker;\n      }\n    }\n    return html + this.strings[endIndex];\n  }\n\n  getTemplateElement(): HTMLTemplateElement {\n    const template = document.createElement('template');\n    template.innerHTML = this.getHTML();\n    return template;\n  }\n}\n\n/**\n * A TemplateResult for SVG fragments.\n *\n * This class wraps HTMl in an `<svg>` tag in order to parse its contents in the\n * SVG namespace, then modifies the template to remove the `<svg>` tag so that\n * clones only container the original fragment.\n */\nexport class SVGTemplateResult extends TemplateResult {\n  getHTML(): string {\n    return `<svg>${super.getHTML()}</svg>`;\n  }\n\n  getTemplateElement(): HTMLTemplateElement {\n    const template = super.getTemplateElement();\n    const content = template.content;\n    const svgElement = content.firstChild!;\n    content.removeChild(svgElement);\n    reparentNodes(content, svgElement.firstChild);\n    return template;\n  }\n}\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {isDirective} from './directive.js';\nimport {removeNodes} from './dom.js';\nimport {noChange, nothing, Part} from './part.js';\nimport {RenderOptions} from './render-options.js';\nimport {TemplateInstance} from './template-instance.js';\nimport {TemplateResult} from './template-result.js';\nimport {createMarker} from './template.js';\n\n// https://tc39.github.io/ecma262/#sec-typeof-operator\nexport type Primitive = null|undefined|boolean|number|string|Symbol|bigint;\nexport const isPrimitive = (value: unknown): value is Primitive => {\n  return (\n      value === null ||\n      !(typeof value === 'object' || typeof value === 'function'));\n};\n\n/**\n * Sets attribute values for AttributeParts, so that the value is only set once\n * even if there are multiple parts for an attribute.\n */\nexport class AttributeCommitter {\n  element: Element;\n  name: string;\n  strings: string[];\n  parts: AttributePart[];\n  dirty = true;\n\n  constructor(element: Element, name: string, strings: string[]) {\n    this.element = element;\n    this.name = name;\n    this.strings = strings;\n    this.parts = [];\n    for (let i = 0; i < strings.length - 1; i++) {\n      this.parts[i] = this._createPart();\n    }\n  }\n\n  /**\n   * Creates a single part. Override this to create a differnt type of part.\n   */\n  protected _createPart(): AttributePart {\n    return new AttributePart(this);\n  }\n\n  protected _getValue(): unknown {\n    const strings = this.strings;\n    const l = strings.length - 1;\n    let text = '';\n\n    for (let i = 0; i < l; i++) {\n      text += strings[i];\n      const part = this.parts[i];\n      if (part !== undefined) {\n        const v = part.value;\n        if (v != null &&\n            (Array.isArray(v) ||\n             // tslint:disable-next-line:no-any\n             typeof v !== 'string' && (v as any)[Symbol.iterator])) {\n          for (const t of v as Iterable<unknown>) {\n            text += typeof t === 'string' ? t : String(t);\n          }\n        } else {\n          text += typeof v === 'string' ? v : String(v);\n        }\n      }\n    }\n\n    text += strings[l];\n    return text;\n  }\n\n  commit(): void {\n    if (this.dirty) {\n      this.dirty = false;\n      this.element.setAttribute(this.name, this._getValue() as string);\n    }\n  }\n}\n\nexport class AttributePart implements Part {\n  committer: AttributeCommitter;\n  value: unknown = undefined;\n\n  constructor(comitter: AttributeCommitter) {\n    this.committer = comitter;\n  }\n\n  setValue(value: unknown): void {\n    if (value !== noChange && (!isPrimitive(value) || value !== this.value)) {\n      this.value = value;\n      // If the value is a not a directive, dirty the committer so that it'll\n      // call setAttribute. If the value is a directive, it'll dirty the\n      // committer if it calls setValue().\n      if (!isDirective(value)) {\n        this.committer.dirty = true;\n      }\n    }\n  }\n\n  commit() {\n    while (isDirective(this.value)) {\n      const directive = this.value;\n      this.value = noChange;\n      directive(this);\n    }\n    if (this.value === noChange) {\n      return;\n    }\n    this.committer.commit();\n  }\n}\n\nexport class NodePart implements Part {\n  options: RenderOptions;\n  startNode!: Node;\n  endNode!: Node;\n  value: unknown = undefined;\n  _pendingValue: unknown = undefined;\n\n  constructor(options: RenderOptions) {\n    this.options = options;\n  }\n\n  /**\n   * Inserts this part into a container.\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n  appendInto(container: Node) {\n    this.startNode = container.appendChild(createMarker());\n    this.endNode = container.appendChild(createMarker());\n  }\n\n  /**\n   * Inserts this part between `ref` and `ref`'s next sibling. Both `ref` and\n   * its next sibling must be static, unchanging nodes such as those that appear\n   * in a literal section of a template.\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n  insertAfterNode(ref: Node) {\n    this.startNode = ref;\n    this.endNode = ref.nextSibling!;\n  }\n\n  /**\n   * Appends this part into a parent part.\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n  appendIntoPart(part: NodePart) {\n    part._insert(this.startNode = createMarker());\n    part._insert(this.endNode = createMarker());\n  }\n\n  /**\n   * Appends this part after `ref`\n   *\n   * This part must be empty, as its contents are not automatically moved.\n   */\n  insertAfterPart(ref: NodePart) {\n    ref._insert(this.startNode = createMarker());\n    this.endNode = ref.endNode;\n    ref.endNode = this.startNode;\n  }\n\n  setValue(value: unknown): void {\n    this._pendingValue = value;\n  }\n\n  commit() {\n    while (isDirective(this._pendingValue)) {\n      const directive = this._pendingValue;\n      this._pendingValue = noChange;\n      directive(this);\n    }\n    const value = this._pendingValue;\n    if (value === noChange) {\n      return;\n    }\n    if (isPrimitive(value)) {\n      if (value !== this.value) {\n        this._commitText(value);\n      }\n    } else if (value instanceof TemplateResult) {\n      this._commitTemplateResult(value);\n    } else if (value instanceof Node) {\n      this._commitNode(value);\n    } else if (\n        Array.isArray(value) ||\n        // tslint:disable-next-line:no-any\n        (value as any)[Symbol.iterator]) {\n      this._commitIterable(value as Iterable<unknown>);\n    } else if (value === nothing) {\n      this.value = nothing;\n      this.clear();\n    } else {\n      // Fallback, will render the string representation\n      this._commitText(value);\n    }\n  }\n\n  private _insert(node: Node) {\n    this.endNode.parentNode!.insertBefore(node, this.endNode);\n  }\n\n  private _commitNode(value: Node): void {\n    if (this.value === value) {\n      return;\n    }\n    this.clear();\n    this._insert(value);\n    this.value = value;\n  }\n\n  private _commitText(value: unknown): void {\n    const node = this.startNode.nextSibling!;\n    value = value == null ? '' : value;\n    if (node === this.endNode.previousSibling &&\n        node.nodeType === 3 /* Node.TEXT_NODE */) {\n      // If we only have a single text node between the markers, we can just\n      // set its value, rather than replacing it.\n      // TODO(justinfagnani): Can we just check if this.value is primitive?\n      (node as Text).data = value as string;\n    } else {\n      this._commitNode(document.createTextNode(\n          typeof value === 'string' ? value : String(value)));\n    }\n    this.value = value;\n  }\n\n  private _commitTemplateResult(value: TemplateResult): void {\n    const template = this.options.templateFactory(value);\n    if (this.value instanceof TemplateInstance &&\n        this.value.template === template) {\n      this.value.update(value.values);\n    } else {\n      // Make sure we propagate the template processor from the TemplateResult\n      // so that we use its syntax extension, etc. The template factory comes\n      // from the render function options so that it can control template\n      // caching and preprocessing.\n      const instance =\n          new TemplateInstance(template, value.processor, this.options);\n      const fragment = instance._clone();\n      instance.update(value.values);\n      this._commitNode(fragment);\n      this.value = instance;\n    }\n  }\n\n  private _commitIterable(value: Iterable<unknown>): void {\n    // For an Iterable, we create a new InstancePart per item, then set its\n    // value to the item. This is a little bit of overhead for every item in\n    // an Iterable, but it lets us recurse easily and efficiently update Arrays\n    // of TemplateResults that will be commonly returned from expressions like:\n    // array.map((i) => html`${i}`), by reusing existing TemplateInstances.\n\n    // If _value is an array, then the previous render was of an\n    // iterable and _value will contain the NodeParts from the previous\n    // render. If _value is not an array, clear this part and make a new\n    // array for NodeParts.\n    if (!Array.isArray(this.value)) {\n      this.value = [];\n      this.clear();\n    }\n\n    // Lets us keep track of how many items we stamped so we can clear leftover\n    // items from a previous render\n    const itemParts = this.value as NodePart[];\n    let partIndex = 0;\n    let itemPart: NodePart|undefined;\n\n    for (const item of value) {\n      // Try to reuse an existing part\n      itemPart = itemParts[partIndex];\n\n      // If no existing part, create a new one\n      if (itemPart === undefined) {\n        itemPart = new NodePart(this.options);\n        itemParts.push(itemPart);\n        if (partIndex === 0) {\n          itemPart.appendIntoPart(this);\n        } else {\n          itemPart.insertAfterPart(itemParts[partIndex - 1]);\n        }\n      }\n      itemPart.setValue(item);\n      itemPart.commit();\n      partIndex++;\n    }\n\n    if (partIndex < itemParts.length) {\n      // Truncate the parts array so _value reflects the current state\n      itemParts.length = partIndex;\n      this.clear(itemPart && itemPart!.endNode);\n    }\n  }\n\n  clear(startNode: Node = this.startNode) {\n    removeNodes(\n        this.startNode.parentNode!, startNode.nextSibling!, this.endNode);\n  }\n}\n\n/**\n * Implements a boolean attribute, roughly as defined in the HTML\n * specification.\n *\n * If the value is truthy, then the attribute is present with a value of\n * ''. If the value is falsey, the attribute is removed.\n */\nexport class BooleanAttributePart implements Part {\n  element: Element;\n  name: string;\n  strings: string[];\n  value: unknown = undefined;\n  _pendingValue: unknown = undefined;\n\n  constructor(element: Element, name: string, strings: string[]) {\n    if (strings.length !== 2 || strings[0] !== '' || strings[1] !== '') {\n      throw new Error(\n          'Boolean attributes can only contain a single expression');\n    }\n    this.element = element;\n    this.name = name;\n    this.strings = strings;\n  }\n\n  setValue(value: unknown): void {\n    this._pendingValue = value;\n  }\n\n  commit() {\n    while (isDirective(this._pendingValue)) {\n      const directive = this._pendingValue;\n      this._pendingValue = noChange;\n      directive(this);\n    }\n    if (this._pendingValue === noChange) {\n      return;\n    }\n    const value = !!this._pendingValue;\n    if (this.value !== value) {\n      if (value) {\n        this.element.setAttribute(this.name, '');\n      } else {\n        this.element.removeAttribute(this.name);\n      }\n    }\n    this.value = value;\n    this._pendingValue = noChange;\n  }\n}\n\n/**\n * Sets attribute values for PropertyParts, so that the value is only set once\n * even if there are multiple parts for a property.\n *\n * If an expression controls the whole property value, then the value is simply\n * assigned to the property under control. If there are string literals or\n * multiple expressions, then the strings are expressions are interpolated into\n * a string first.\n */\nexport class PropertyCommitter extends AttributeCommitter {\n  single: boolean;\n\n  constructor(element: Element, name: string, strings: string[]) {\n    super(element, name, strings);\n    this.single =\n        (strings.length === 2 && strings[0] === '' && strings[1] === '');\n  }\n\n  protected _createPart(): PropertyPart {\n    return new PropertyPart(this);\n  }\n\n  _getValue() {\n    if (this.single) {\n      return this.parts[0].value;\n    }\n    return super._getValue();\n  }\n\n  commit(): void {\n    if (this.dirty) {\n      this.dirty = false;\n      // tslint:disable-next-line:no-any\n      (this.element as any)[this.name] = this._getValue();\n    }\n  }\n}\n\nexport class PropertyPart extends AttributePart {}\n\n// Detect event listener options support. If the `capture` property is read\n// from the options object, then options are supported. If not, then the thrid\n// argument to add/removeEventListener is interpreted as the boolean capture\n// value so we should only pass the `capture` property.\nlet eventOptionsSupported = false;\n\ntry {\n  const options = {\n    get capture() {\n      eventOptionsSupported = true;\n      return false;\n    }\n  };\n  // tslint:disable-next-line:no-any\n  window.addEventListener('test', options as any, options);\n  // tslint:disable-next-line:no-any\n  window.removeEventListener('test', options as any, options);\n} catch (_e) {\n}\n\n\ntype EventHandlerWithOptions =\n    EventListenerOrEventListenerObject&Partial<AddEventListenerOptions>;\nexport class EventPart implements Part {\n  element: Element;\n  eventName: string;\n  eventContext?: EventTarget;\n  value: undefined|EventHandlerWithOptions = undefined;\n  _options?: AddEventListenerOptions;\n  _pendingValue: undefined|EventHandlerWithOptions = undefined;\n  _boundHandleEvent: (event: Event) => void;\n\n  constructor(element: Element, eventName: string, eventContext?: EventTarget) {\n    this.element = element;\n    this.eventName = eventName;\n    this.eventContext = eventContext;\n    this._boundHandleEvent = (e) => this.handleEvent(e);\n  }\n\n  setValue(value: undefined|EventHandlerWithOptions): void {\n    this._pendingValue = value;\n  }\n\n  commit() {\n    while (isDirective(this._pendingValue)) {\n      const directive = this._pendingValue;\n      this._pendingValue = noChange as EventHandlerWithOptions;\n      directive(this);\n    }\n    if (this._pendingValue === noChange) {\n      return;\n    }\n\n    const newListener = this._pendingValue;\n    const oldListener = this.value;\n    const shouldRemoveListener = newListener == null ||\n        oldListener != null &&\n            (newListener.capture !== oldListener.capture ||\n             newListener.once !== oldListener.once ||\n             newListener.passive !== oldListener.passive);\n    const shouldAddListener =\n        newListener != null && (oldListener == null || shouldRemoveListener);\n\n    if (shouldRemoveListener) {\n      this.element.removeEventListener(\n          this.eventName, this._boundHandleEvent, this._options);\n    }\n    if (shouldAddListener) {\n      this._options = getOptions(newListener);\n      this.element.addEventListener(\n          this.eventName, this._boundHandleEvent, this._options);\n    }\n    this.value = newListener;\n    this._pendingValue = noChange as EventHandlerWithOptions;\n  }\n\n  handleEvent(event: Event) {\n    if (typeof this.value === 'function') {\n      this.value.call(this.eventContext || this.element, event);\n    } else {\n      (this.value as EventListenerObject).handleEvent(event);\n    }\n  }\n}\n\n// We copy options because of the inconsistent behavior of browsers when reading\n// the third argument of add/removeEventListener. IE11 doesn't support options\n// at all. Chrome 41 only reads `capture` if the argument is an object.\nconst getOptions = (o: AddEventListenerOptions|undefined) => o &&\n    (eventOptionsSupported ?\n         {capture: o.capture, passive: o.passive, once: o.once} :\n         o.capture as AddEventListenerOptions);\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {Part} from './part.js';\nimport {AttributeCommitter, BooleanAttributePart, EventPart, NodePart, PropertyCommitter} from './parts.js';\nimport {RenderOptions} from './render-options.js';\nimport {TemplateProcessor} from './template-processor.js';\n\n/**\n * Creates Parts when a template is instantiated.\n */\nexport class DefaultTemplateProcessor implements TemplateProcessor {\n  /**\n   * Create parts for an attribute-position binding, given the event, attribute\n   * name, and string literals.\n   *\n   * @param element The element containing the binding\n   * @param name  The attribute name\n   * @param strings The string literals. There are always at least two strings,\n   *   event for fully-controlled bindings with a single expression.\n   */\n  handleAttributeExpressions(\n      element: Element, name: string, strings: string[],\n      options: RenderOptions): Part[] {\n    const prefix = name[0];\n    if (prefix === '.') {\n      const comitter = new PropertyCommitter(element, name.slice(1), strings);\n      return comitter.parts;\n    }\n    if (prefix === '@') {\n      return [new EventPart(element, name.slice(1), options.eventContext)];\n    }\n    if (prefix === '?') {\n      return [new BooleanAttributePart(element, name.slice(1), strings)];\n    }\n    const comitter = new AttributeCommitter(element, name, strings);\n    return comitter.parts;\n  }\n  /**\n   * Create parts for a text-position binding.\n   * @param templateFactory\n   */\n  handleTextExpression(options: RenderOptions) {\n    return new NodePart(options);\n  }\n}\n\nexport const defaultTemplateProcessor = new DefaultTemplateProcessor();\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {TemplateResult} from './template-result.js';\nimport {marker, Template} from './template.js';\n\n/**\n * A function type that creates a Template from a TemplateResult.\n *\n * This is a hook into the template-creation process for rendering that\n * requires some modification of templates before they're used, like ShadyCSS,\n * which must add classes to elements and remove styles.\n *\n * Templates should be cached as aggressively as possible, so that many\n * TemplateResults produced from the same expression only do the work of\n * creating the Template the first time.\n *\n * Templates are usually cached by TemplateResult.strings and\n * TemplateResult.type, but may be cached by other keys if this function\n * modifies the template.\n *\n * Note that currently TemplateFactories must not add, remove, or reorder\n * expressions, because there is no way to describe such a modification\n * to render() so that values are interpolated to the correct place in the\n * template instances.\n */\nexport type TemplateFactory = (result: TemplateResult) => Template;\n\n/**\n * The default TemplateFactory which caches Templates keyed on\n * result.type and result.strings.\n */\nexport function templateFactory(result: TemplateResult) {\n  let templateCache = templateCaches.get(result.type);\n  if (templateCache === undefined) {\n    templateCache = {\n      stringsArray: new WeakMap<TemplateStringsArray, Template>(),\n      keyString: new Map<string, Template>()\n    };\n    templateCaches.set(result.type, templateCache);\n  }\n\n  let template = templateCache.stringsArray.get(result.strings);\n  if (template !== undefined) {\n    return template;\n  }\n\n  // If the TemplateStringsArray is new, generate a key from the strings\n  // This key is shared between all templates with identical content\n  const key = result.strings.join(marker);\n\n  // Check if we already have a Template for this key\n  template = templateCache.keyString.get(key);\n  if (template === undefined) {\n    // If we have not seen this key before, create a new Template\n    template = new Template(result, result.getTemplateElement());\n    // Cache the Template for this key\n    templateCache.keyString.set(key, template);\n  }\n\n  // Cache all future queries for this TemplateStringsArray\n  templateCache.stringsArray.set(result.strings, template);\n  return template;\n}\n\n/**\n * The first argument to JS template tags retain identity across multiple\n * calls to a tag for the same literal, so we can cache work done per literal\n * in a Map.\n *\n * Safari currently has a bug which occasionally breaks this behaviour, so we\n * need to cache the Template at two levels. We first cache the\n * TemplateStringsArray, and if that fails, we cache a key constructed by\n * joining the strings array.\n */\nexport type templateCache = {\n  stringsArray: WeakMap<TemplateStringsArray, Template>;\n  keyString: Map<string, Template>;\n};\n\nexport const templateCaches = new Map<string, templateCache>();\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n * @module lit-html\n */\n\nimport {removeNodes} from './dom.js';\nimport {NodePart} from './parts.js';\nimport {RenderOptions} from './render-options.js';\nimport {templateFactory} from './template-factory.js';\nimport {TemplateResult} from './template-result.js';\n\nexport const parts = new WeakMap<Node, NodePart>();\n\n/**\n * Renders a template to a container.\n *\n * To update a container with new values, reevaluate the template literal and\n * call `render` with the new result.\n *\n * @param result a TemplateResult created by evaluating a template tag like\n *     `html` or `svg`.\n * @param container A DOM parent to render to. The entire contents are either\n *     replaced, or efficiently updated if the same result type was previous\n *     rendered there.\n * @param options RenderOptions for the entire render tree rendered to this\n *     container. Render options must *not* change between renders to the same\n *     container, as those changes will not effect previously rendered DOM.\n */\nexport const render =\n    (result: TemplateResult,\n     container: Element|DocumentFragment,\n     options?: Partial<RenderOptions>) => {\n      let part = parts.get(container);\n      if (part === undefined) {\n        removeNodes(container, container.firstChild);\n        parts.set(container, part = new NodePart({\n                               templateFactory,\n                               ...options,\n                             }));\n        part.appendInto(container);\n      }\n      part.setValue(result);\n      part.commit();\n    };\n","/**\n * @license\n * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at\n * http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at\n * http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at\n * http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at\n * http://polymer.github.io/PATENTS.txt\n */\n\n/**\n *\n * Main lit-html module.\n *\n * Main exports:\n *\n * -  [[html]]\n * -  [[svg]]\n * -  [[render]]\n *\n * @module lit-html\n * @preferred\n */\n\n/**\n * Do not remove this comment; it keeps typedoc from misplacing the module\n * docs.\n */\nimport {defaultTemplateProcessor} from './lib/default-template-processor.js';\nimport {SVGTemplateResult, TemplateResult} from './lib/template-result.js';\n\nexport {DefaultTemplateProcessor, defaultTemplateProcessor} from './lib/default-template-processor.js';\nexport {directive, DirectiveFn, isDirective} from './lib/directive.js';\n// TODO(justinfagnani): remove line when we get NodePart moving methods\nexport {removeNodes, reparentNodes} from './lib/dom.js';\nexport {noChange, nothing, Part} from './lib/part.js';\nexport {AttributeCommitter, AttributePart, BooleanAttributePart, EventPart, isPrimitive, NodePart, PropertyCommitter, PropertyPart} from './lib/parts.js';\nexport {RenderOptions} from './lib/render-options.js';\nexport {parts, render} from './lib/render.js';\nexport {templateCaches, templateFactory} from './lib/template-factory.js';\nexport {TemplateInstance} from './lib/template-instance.js';\nexport {TemplateProcessor} from './lib/template-processor.js';\nexport {SVGTemplateResult, TemplateResult} from './lib/template-result.js';\nexport {createMarker, isTemplatePartActive, Template} from './lib/template.js';\n\ndeclare global {\n  interface Window {\n    litHtmlVersions: string[];\n  }\n}\n\n// IMPORTANT: do not change the property name or the assignment expression.\n// This line will be used in regexes to search for lit-html usage.\n// TODO(justinfagnani): inject version number at build time\n(window['litHtmlVersions'] || (window['litHtmlVersions'] = [])).push('1.0.0');\n\n/**\n * Interprets a template literal as an HTML template that can efficiently\n * render to and update a container.\n */\nexport const html = (strings: TemplateStringsArray, ...values: unknown[]) =>\n    new TemplateResult(strings, values, 'html', defaultTemplateProcessor);\n\n/**\n * Interprets a template literal as an SVG template that can efficiently\n * render to and update a container.\n */\nexport const svg = (strings: TemplateStringsArray, ...values: unknown[]) =>\n    new SVGTemplateResult(strings, values, 'svg', defaultTemplateProcessor);\n","import { render, directive } from 'lit-html';\nexport { html, render } from 'lit-html';\n\nconst symbolFor = typeof Symbol === 'function' ? Symbol.for : str => str;\n\nconst phaseSymbol = symbolFor('haunted.phase');\nconst hookSymbol = symbolFor('haunted.hook');\n\nconst updateSymbol = symbolFor('haunted.update');\nconst commitSymbol = symbolFor('haunted.commit');\nconst effectsSymbol = symbolFor('haunted.effects');\nconst contextSymbol = symbolFor('haunted.context');\n\nconst contextEvent = 'haunted.context';\n\nlet current;\nlet currentId = 0;\n\nfunction setCurrent(element) {\n  current = element;\n}\n\nfunction clear() {\n  current = null;\n  currentId = 0;\n}\n\nfunction notify() {\n  let id = currentId;\n  currentId++;\n  return id;\n}\n\nconst defer = typeof Promise=='function' ? Promise.resolve().then.bind(Promise.resolve()) : setTimeout;\n\nfunction scheduler() {\n  let tasks = [];\n  let id;\n\n  function runTasks() {\n    id = null;\n    let t = tasks;\n    tasks = [];\n    for(var i = 0, len = t.length; i < len; i++) {\n      t[i]();\n    }\n  }\n\n  return function(task) {\n    tasks.push(task);\n    if(id == null) {\n      id = defer(runTasks);\n    }\n  };\n}\n\nconst read = scheduler();\nconst write = scheduler();\n\nclass Container {\n  constructor(renderer, frag, host) {\n    this.renderer = renderer;\n    this.frag = frag;\n    this.host = host || frag;\n    this[hookSymbol] = new Map();\n    this[phaseSymbol] = null;\n    this._updateQueued = false;\n  }\n\n  update() {\n    if(this._updateQueued) return;\n    read(() => {\n      let result = this.handlePhase(updateSymbol);\n      write(() => {\n        this.handlePhase(commitSymbol, result);\n\n        if(this[effectsSymbol]) {\n          write(() => {\n            this.handlePhase(effectsSymbol);\n          });\n        }\n      });\n      this._updateQueued = false;\n    });\n    this._updateQueued = true;\n  }\n\n  handlePhase(phase, arg) {\n    this[phaseSymbol] = phase;\n    switch(phase) {\n      case commitSymbol: return this.commit(arg);\n      case updateSymbol: return this.render();\n      case effectsSymbol: return this.runEffects(effectsSymbol);\n    }\n    this[phaseSymbol] = null;\n  }\n\n  commit(result) {\n    render(result, this.frag);\n    this.runEffects(commitSymbol);\n  }\n\n  render() {\n    setCurrent(this);\n    let result = this.args ?\n      this.renderer.apply(this.host, this.args) :\n      this.renderer.call(this.host, this.host);\n    clear();\n    return result;\n  }\n\n  runEffects(symbol) {\n    let effects = this[symbol];\n    if(effects) {\n      setCurrent(this);\n      for(let effect of effects) {\n        effect.call(this);\n      }\n      clear();\n    }\n  }\n\n  teardown() {\n    let hooks = this[hookSymbol];\n    hooks.forEach((hook) => {\n      if (typeof hook.teardown === 'function') {\n        hook.teardown();\n      }\n    });\n  }\n}\n\nfunction toCamelCase(val = '') {\n  return val.indexOf('-') === -1 ? val.toLowerCase() : val.toLowerCase().split('-').reduce((out, part) => {\n    return out ? out + part.charAt(0).toUpperCase() + part.slice(1) : part;\n  },'') \n}\n\nfunction component(renderer, BaseElement = HTMLElement, options = {useShadowDOM: true}) {\n  class Element extends BaseElement {\n    static get observedAttributes() {\n      return renderer.observedAttributes || [];\n    }\n\n    constructor() {\n      super();\n      if (options.useShadowDOM === false) {\n        this._container = new Container(renderer, this);\n      } else {\n        this.attachShadow({ mode: 'open' });\n        this._container = new Container(renderer, this.shadowRoot, this);        \n      }\n    }\n\n    connectedCallback() {\n      this._container.update();\n    }\n\n    disconnectedCallback() {\n      this._container.teardown();\n    }\n\n    attributeChangedCallback(name, _, newValue) {\n      let val = newValue === '' ? true : newValue;\n      Reflect.set(this, toCamelCase(name), val);\n    }\n  }\n  function reflectiveProp(initialValue) {\n    let value = initialValue;\n    return Object.freeze({\n      enumerable: true,\n      configurable: true,\n      get() {\n        return value;\n      },\n      set(newValue) {\n        value = newValue;\n        this._container.update();\n      }\n    })\n  }\n\n  const proto = new Proxy(BaseElement.prototype, {\n    set(target, key, value, receiver) {\n      if(key in target) {\n        Reflect.set(target, key, value);\n      }\n      let desc;\n      if(typeof key === 'symbol' || key[0] === '_') {\n        desc = {\n          enumerable: true,\n          configurable: true,\n          writable: true,\n          value\n        }; \n      } else {\n        desc = reflectiveProp(value);\n      }\n      Object.defineProperty(receiver, key, desc);\n\n      if(desc.set) {\n        desc.set.call(receiver, value);\n      }\n\n      return true;\n    }\n  });\n\n  Object.setPrototypeOf(Element.prototype, proto);\n\n\n  return Element;\n}\n\nclass Hook {\n  constructor(id, el) {\n    this.id = id;\n    this.el = el;\n  }\n}\n\nfunction use(Hook, ...args) {\n  let id = notify();\n  let hooks = current[hookSymbol];\n  \n  let hook = hooks.get(id);\n  if(!hook) {\n    hook = new Hook(id, current, ...args);\n    hooks.set(id, hook);\n  }\n\n  return hook.update(...args);\n}\n\nfunction hook(Hook) {\n  return use.bind(null, Hook);\n}\n\nconst useMemo = hook(class extends Hook {\n  constructor(id, el, fn, values) {\n    super(id, el);\n    this.value = fn();\n    this.values = values;\n  }\n\n  update(fn, values) {\n    if(this.hasChanged(values)) {\n      this.values = values;\n      this.value = fn();\n    }\n    return this.value;\n  }\n\n  hasChanged(values) {\n    return values.some((value, i) => this.values[i] !== value);\n  }\n});\n\nconst useCallback = (fn, inputs) => useMemo(() => fn, inputs);\n\nfunction setEffects(el, cb) {\n  if(!(effectsSymbol in el)) {\n    el[effectsSymbol] = [];\n  }\n  el[effectsSymbol].push(cb);\n}\n\nconst useEffect = hook(class extends Hook {\n  constructor(id, el) {\n    super(id, el);\n    this.values = false;\n    setEffects(el, this);\n  }\n\n  update(callback, values) {\n    this.callback = callback;\n    this.lastValues = this.values;\n    this.values = values;\n  }\n\n  call() {\n    if(this.values) {\n      if(this.hasChanged()) {\n        this.run();\n      }\n    } else {\n      this.run();\n    }\n  }\n\n  run() {\n    this.teardown();\n    this._teardown = this.callback.call(this.el);\n  }\n\n  teardown() {\n    if(this._teardown) {\n      this._teardown();\n    }\n  }\n\n  hasChanged() {\n    return this.lastValues === false || this.values.some((value, i) => this.lastValues[i] !== value);\n  }\n});\n\nconst useState = hook(class extends Hook {\n  constructor(id, el, initialValue) {\n    super(id, el);\n    this.updater = this.updater.bind(this);\n    this.makeArgs(initialValue);\n  }\n\n  update() {\n    return this.args;\n  }\n\n  updater(value) {\n    if (typeof value === \"function\") {\n      const updaterFn = value;\n      const [previousValue] = this.args;\n      value = updaterFn(previousValue);\n    }\n\n    this.makeArgs(value);\n    this.el.update();\n  }\n\n  makeArgs(value) {\n    this.args = Object.freeze([value, this.updater]);\n  }\n});\n\nconst useReducer = hook(class extends Hook {\n  constructor(id, el, _, initialState) {\n    super(id, el);\n    this.dispatch = this.dispatch.bind(this);\n    this.state = initialState;\n  }\n\n  update(reducer) {\n    this.reducer = reducer;\n    return [this.state, this.dispatch];\n  }\n\n  dispatch(action) {\n    this.state = this.reducer(this.state, action);\n    this.el.update();\n  }\n});\n\nclass DirectiveContainer extends Container {\n  constructor(renderer, part) {\n    super(renderer, part);\n    this.virtual = true;\n  }\n\n  commit(result) {\n    this.host.setValue(result);\n    this.host.commit();\n  }\n}\n\nconst map = new WeakMap();\n\nfunction withHooks(renderer) {\n  function factory(...args) {\n    return part => {\n      let cont = map.get(part);\n      if(!cont) {\n        cont = new DirectiveContainer(renderer, part);\n        map.set(part, cont);\n      }\n      cont.args = args;\n      cont.update();\n    };\n  }\n\n  return directive(factory);\n}\n\nfunction setContexts(el, consumer) {\n  if(!(contextSymbol in el)) {\n    el[contextSymbol] = [];\n  }\n  el[contextSymbol].push(consumer);\n}\n\nconst useContext = hook(class extends Hook {\n  constructor(id, el) {\n    super(id, el);\n    setContexts(el, this);\n    this._updater = this._updater.bind(this);\n  }\n\n  update(Context) {\n    if (this.el.virtual) {\n      throw new Error('can\\'t be used with virtual components');\n    }\n\n    if (this.Context !== Context) {\n      this._subscribe(Context);\n      this.Context = Context;\n    }\n\n    return this.value;\n  }\n\n  _updater(value) {\n    this.value = value;\n    this.el.update();\n  }\n\n  _subscribe(Context) {\n    const detail = { Context, callback: this._updater };\n\n    this.el.host.dispatchEvent(new CustomEvent(contextEvent, {\n      detail, // carrier\n      bubbles: true, // to bubble up in tree\n      cancelable: true, // to be able to cancel\n      composed: true, // to pass ShadowDOM boundaries\n    }));\n\n    const { unsubscribe, value } = detail;\n\n    this.value = unsubscribe ? value : Context.defaultValue;\n\n    this._unsubscribe = unsubscribe;\n  }\n\n  teardown() {\n    if (this._unsubscribe) {\n      this._unsubscribe();\n    }\n  }\n});\n\nconst createContext = (defaultValue) => {\n  const Context = {};\n  \n  Context.Provider = class extends HTMLElement {\n    constructor() {\n      super();\n      this.listeners = [];\n  \n      this.eventHandler = (event) => {\n        const { detail } = event;\n      \n        if (detail.Context === Context) {\n          detail.value = this.value;\n      \n          detail.unsubscribe = () => {\n            const index = this.listeners.indexOf(detail.callback);\n\n            if (index > -1) {\n              this.listeners.splice(index, 1);\n            }\n          };\n\n          this.listeners.push(detail.callback);\n  \n          event.stopPropagation();\n        }\n      };\n  \n      this.addEventListener(contextEvent, this.eventHandler);\n    }\n  \n    disconnectedCallback() {\n      this.removeEventListener(contextEvent, this.eventHandler);\n    }\n\n    set value(value) {\n      this._value = value;\n      this.listeners.forEach(callback => callback(value));\n    }\n\n    get value() {\n      return this._value;\n    }\n  };\n\n  Context.Consumer = component(function ({ render: render$$1 }) {\n    const context = useContext(Context);\n\n    return render$$1(context);\n  });\n\n  Context.defaultValue = defaultValue;\n\n  return Context;\n};\n\nexport { component, useCallback, useEffect, useState, useReducer, useMemo, withHooks, withHooks as virtual, useContext, createContext, hook, Hook };\n","import { hook, Hook } from \"haunted-w-microtask\";\n\n/**\n * Purpose: Provided callback will be called when containerement is disconnected from DOM.\n *          Useful for doing cleanup.\n * Example Usage:\n * ```\n * useDisconnected(callback)\n * ```\n */\nconst useDisconnected = hook(\n  class extends Hook {\n    _callback: Function;\n    constructor(id, container, callback) {\n      super(id, container);\n      this._callback = callback;\n    }\n\n    update(): void {}\n\n    teardown(): void {\n      this._callback();\n    }\n  }\n);\n\nexport { useDisconnected };\n","import { hook, Hook } from \"haunted-w-microtask\";\n\n/**\n * Purpose: Returns a function that will queue the element for updating\n * Example Usage:\n * ```\n * const updateFn = useTriggerUpdate();\n * ```\n */\nconst useTriggerUpdate = hook(\n  class extends Hook {\n    _container: { update: Function };\n    constructor(id, container) {\n      super(id, container);\n      this._container = container;\n    }\n\n    update(): Function {\n      return this._container.update.bind(this._container);\n    }\n  }\n);\n\nexport { useTriggerUpdate };\n","export default function symbolObservablePonyfill(root) {\n\tvar result;\n\tvar Symbol = root.Symbol;\n\n\tif (typeof Symbol === 'function') {\n\t\tif (Symbol.observable) {\n\t\t\tresult = Symbol.observable;\n\t\t} else {\n\t\t\tresult = Symbol('observable');\n\t\t\tSymbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n};\n","/* global window */\nimport ponyfill from './ponyfill.js';\n\nvar root;\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof global !== 'undefined') {\n  root = global;\n} else if (typeof module !== 'undefined') {\n  root = module;\n} else {\n  root = Function('return this')();\n}\n\nvar result = ponyfill(root);\nexport default result;\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar makeOptions = function (opts) {\r\n    if (opts === void 0) { opts = {}; }\r\n    return ({\r\n        arrayFormat: opts.arrayFormat || 'none',\r\n        booleanFormat: opts.booleanFormat || 'none',\r\n        nullFormat: opts.nullFormat || 'default'\r\n    });\r\n};\r\nvar encodeValue = function (value) { return encodeURIComponent(value); };\r\nvar decodeValue = function (value) { return decodeURIComponent(value); };\r\nvar encodeBoolean = function (name, value, opts) {\r\n    if (opts.booleanFormat === 'empty-true' && value) {\r\n        return name;\r\n    }\r\n    var encodedValue;\r\n    if (opts.booleanFormat === 'unicode') {\r\n        encodedValue = value ? '✓' : '✗';\r\n    }\r\n    else {\r\n        encodedValue = value.toString();\r\n    }\r\n    return name + \"=\" + encodedValue;\r\n};\r\nvar encodeNull = function (name, opts) {\r\n    if (opts.nullFormat === 'hidden') {\r\n        return '';\r\n    }\r\n    if (opts.nullFormat === 'string') {\r\n        return name + \"=null\";\r\n    }\r\n    return name;\r\n};\r\nvar getNameEncoder = function (opts) {\r\n    if (opts.arrayFormat === 'index') {\r\n        return function (name, index) { return name + \"[\" + index + \"]\"; };\r\n    }\r\n    if (opts.arrayFormat === 'brackets') {\r\n        return function (name) { return name + \"[]\"; };\r\n    }\r\n    return function (name) { return name; };\r\n};\r\nvar encodeArray = function (name, arr, opts) {\r\n    var encodeName = getNameEncoder(opts);\r\n    return arr\r\n        .map(function (val, index) { return encodeName(name, index) + \"=\" + encodeValue(val); })\r\n        .join('&');\r\n};\r\nvar encode = function (name, value, opts) {\r\n    if (value === null) {\r\n        return encodeNull(name, opts);\r\n    }\r\n    if (typeof value === 'boolean') {\r\n        return encodeBoolean(name, value, opts);\r\n    }\r\n    if (Array.isArray(value)) {\r\n        return encodeArray(name, value, opts);\r\n    }\r\n    return name + \"=\" + encodeValue(value);\r\n};\r\nvar decode = function (value, opts) {\r\n    if (value === undefined) {\r\n        return opts.booleanFormat === 'empty-true' ? true : null;\r\n    }\r\n    if (opts.booleanFormat === 'string') {\r\n        if (value === 'true') {\r\n            return true;\r\n        }\r\n        if (value === 'false') {\r\n            return false;\r\n        }\r\n    }\r\n    else if (opts.booleanFormat === 'unicode') {\r\n        if (decodeValue(value) === '✓') {\r\n            return true;\r\n        }\r\n        if (decodeValue(value) === '✗') {\r\n            return false;\r\n        }\r\n    }\r\n    else if (opts.nullFormat === 'string') {\r\n        if (value === 'null') {\r\n            return null;\r\n        }\r\n    }\r\n    return decodeValue(value);\r\n};\n\nvar getSearch = function (path) {\r\n    var pos = path.indexOf('?');\r\n    if (pos === -1) {\r\n        return path;\r\n    }\r\n    return path.slice(pos + 1);\r\n};\r\nvar isSerialisable = function (val) { return val !== undefined; };\r\nvar parseName = function (name) {\r\n    var bracketPosition = name.indexOf('[');\r\n    var hasBrackets = bracketPosition !== -1;\r\n    return {\r\n        hasBrackets: hasBrackets,\r\n        name: hasBrackets ? name.slice(0, bracketPosition) : name\r\n    };\r\n};\n\n/**\r\n * Parse a querystring and return an object of parameters\r\n */\r\nvar parse = function (path, opts) {\r\n    var options = makeOptions(opts);\r\n    return getSearch(path)\r\n        .split('&')\r\n        .reduce(function (params, param) {\r\n        var _a = param.split('='), rawName = _a[0], value = _a[1];\r\n        var _b = parseName(rawName), hasBrackets = _b.hasBrackets, name = _b.name;\r\n        var currentValue = params[name];\r\n        var decodedValue = decode(value, options);\r\n        if (currentValue === undefined) {\r\n            params[name] = hasBrackets ? [decodedValue] : decodedValue;\r\n        }\r\n        else {\r\n            params[name] = [].concat(currentValue, decodedValue);\r\n        }\r\n        return params;\r\n    }, {});\r\n};\r\n/**\r\n * Build a querystring from an object of parameters\r\n */\r\nvar build = function (params, opts) {\r\n    var options = makeOptions(opts);\r\n    return Object.keys(params)\r\n        .filter(function (paramName) { return isSerialisable(params[paramName]); })\r\n        .map(function (paramName) { return encode(paramName, params[paramName], options); })\r\n        .filter(Boolean)\r\n        .join('&');\r\n};\r\n/**\r\n * Remove a list of parameters from a querystring\r\n */\r\nvar omit = function (path, paramsToOmit, opts) {\r\n    var options = makeOptions(opts);\r\n    var searchPart = getSearch(path);\r\n    if (searchPart === '') {\r\n        return {\r\n            querystring: '',\r\n            removedParams: {}\r\n        };\r\n    }\r\n    var _a = path.split('&').reduce(function (_a, chunk) {\r\n        var left = _a[0], right = _a[1];\r\n        var rawName = chunk.split('=')[0];\r\n        var name = parseName(rawName).name;\r\n        return paramsToOmit.indexOf(name) === -1\r\n            ? [left.concat(chunk), right]\r\n            : [left, right.concat(chunk)];\r\n    }, [[], []]), kept = _a[0], removed = _a[1];\r\n    return {\r\n        querystring: kept.join('&'),\r\n        removedParams: parse(removed.join('&'), options)\r\n    };\r\n};\r\n/**\r\n * Remove a list of parameters from a querystring\r\n */\r\nvar keep = function (path, paramsToKeep, opts) {\r\n    var options = makeOptions(opts);\r\n    var searchPart = getSearch(path);\r\n    if (searchPart === '') {\r\n        return {\r\n            keptParams: {},\r\n            querystring: ''\r\n        };\r\n    }\r\n    var _a = path.split('&').reduce(function (_a, chunk) {\r\n        var left = _a[0], right = _a[1];\r\n        var rawName = chunk.split('=')[0];\r\n        var name = parseName(rawName).name;\r\n        return paramsToKeep.indexOf(name) >= 0\r\n            ? [left.concat(chunk), right]\r\n            : [left, right.concat(chunk)];\r\n    }, [[], []]), kept = _a[0], removed = _a[1];\r\n    return {\r\n        keptParams: parse(kept.join('&'), options),\r\n        querystring: kept.join('&')\r\n    };\r\n};\n\nexports.parse = parse;\nexports.build = build;\nexports.omit = omit;\nexports.keep = keep;\n","import { build, parse } from 'search-params';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nvar __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n};\n\nvar defaultOrConstrained = function (match) {\r\n    return '(' +\r\n        (match ? match.replace(/(^<|>$)/g, '') : \"[a-zA-Z0-9-_.~%':|=+\\\\*@]+\") +\r\n        ')';\r\n};\r\nvar rules = [\r\n    {\r\n        name: 'url-parameter',\r\n        pattern: /^:([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})(<(.+?)>)?/,\r\n        regex: function (match) {\r\n            return new RegExp(defaultOrConstrained(match[2]));\r\n        }\r\n    },\r\n    {\r\n        name: 'url-parameter-splat',\r\n        pattern: /^\\*([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})/,\r\n        regex: /([^?]*)/\r\n    },\r\n    {\r\n        name: 'url-parameter-matrix',\r\n        pattern: /^;([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})(<(.+?)>)?/,\r\n        regex: function (match) {\r\n            return new RegExp(';' + match[1] + '=' + defaultOrConstrained(match[2]));\r\n        }\r\n    },\r\n    {\r\n        name: 'query-parameter',\r\n        pattern: /^(?:\\?|&)(?::)?([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})/\r\n    },\r\n    {\r\n        name: 'delimiter',\r\n        pattern: /^(\\/|\\?)/,\r\n        regex: function (match) { return new RegExp('\\\\' + match[0]); }\r\n    },\r\n    {\r\n        name: 'sub-delimiter',\r\n        pattern: /^(!|&|-|_|\\.|;)/,\r\n        regex: function (match) { return new RegExp(match[0]); }\r\n    },\r\n    {\r\n        name: 'fragment',\r\n        pattern: /^([0-9a-zA-Z]+)/,\r\n        regex: function (match) { return new RegExp(match[0]); }\r\n    }\r\n];\n\nvar tokenise = function (str, tokens) {\r\n    if (tokens === void 0) { tokens = []; }\r\n    // Look for a matching rule\r\n    var matched = rules.some(function (rule) {\r\n        var match = str.match(rule.pattern);\r\n        if (!match) {\r\n            return false;\r\n        }\r\n        tokens.push({\r\n            type: rule.name,\r\n            match: match[0],\r\n            val: match.slice(1, 2),\r\n            otherVal: match.slice(2),\r\n            regex: rule.regex instanceof Function ? rule.regex(match) : rule.regex\r\n        });\r\n        if (match[0].length < str.length) {\r\n            tokens = tokenise(str.substr(match[0].length), tokens);\r\n        }\r\n        return true;\r\n    });\r\n    // If no rules matched, throw an error (possible malformed path)\r\n    if (!matched) {\r\n        throw new Error(\"Could not parse path '\" + str + \"'\");\r\n    }\r\n    return tokens;\r\n};\n\nvar identity = function (_) { return _; };\r\nvar exists = function (val) { return val !== undefined && val !== null; };\r\nvar optTrailingSlash = function (source, strictTrailingSlash) {\r\n    if (strictTrailingSlash) {\r\n        return source;\r\n    }\r\n    if (source === '\\\\/') {\r\n        return source;\r\n    }\r\n    return source.replace(/\\\\\\/$/, '') + '(?:\\\\/)?';\r\n};\r\nvar upToDelimiter = function (source, delimiter) {\r\n    if (!delimiter) {\r\n        return source;\r\n    }\r\n    return /(\\/)$/.test(source) ? source : source + '(\\\\/|\\\\?|\\\\.|;|$)';\r\n};\r\nvar appendQueryParam = function (params, param, val) {\r\n    if (val === void 0) { val = ''; }\r\n    var existingVal = params[param];\r\n    if (existingVal === undefined) {\r\n        params[param] = val;\r\n    }\r\n    else {\r\n        params[param] = Array.isArray(existingVal)\r\n            ? existingVal.concat(val)\r\n            : [existingVal, val];\r\n    }\r\n    return params;\r\n};\r\nvar Path = /** @class */ (function () {\r\n    function Path(path) {\r\n        if (!path) {\r\n            throw new Error('Missing path in Path constructor');\r\n        }\r\n        this.path = path;\r\n        this.tokens = tokenise(path);\r\n        this.hasUrlParams =\r\n            this.tokens.filter(function (t) { return /^url-parameter/.test(t.type); }).length > 0;\r\n        this.hasSpatParam =\r\n            this.tokens.filter(function (t) { return /splat$/.test(t.type); }).length > 0;\r\n        this.hasMatrixParams =\r\n            this.tokens.filter(function (t) { return /matrix$/.test(t.type); }).length > 0;\r\n        this.hasQueryParams =\r\n            this.tokens.filter(function (t) { return /^query-parameter/.test(t.type); }).length > 0;\r\n        // Extract named parameters from tokens\r\n        this.spatParams = this.getParams('url-parameter-splat');\r\n        this.urlParams = this.getParams(/^url-parameter/);\r\n        // Query params\r\n        this.queryParams = this.getParams('query-parameter');\r\n        // All params\r\n        this.params = this.urlParams.concat(this.queryParams);\r\n        // Check if hasQueryParams\r\n        // Regular expressions for url part only (full and partial match)\r\n        this.source = this.tokens\r\n            .filter(function (t) { return t.regex !== undefined; })\r\n            .map(function (r) { return r.regex.source; })\r\n            .join('');\r\n    }\r\n    Path.createPath = function (path) {\r\n        return new Path(path);\r\n    };\r\n    Path.prototype.isQueryParam = function (name) {\r\n        return this.queryParams.indexOf(name) !== -1;\r\n    };\r\n    Path.prototype.test = function (path, opts) {\r\n        var _this = this;\r\n        var options = __assign({ strictTrailingSlash: false, queryParams: {} }, opts);\r\n        // trailingSlash: falsy => non optional, truthy => optional\r\n        var source = optTrailingSlash(this.source, options.strictTrailingSlash);\r\n        // Check if exact match\r\n        var match = this.urlTest(path, source + (this.hasQueryParams ? '(\\\\?.*$|$)' : '$'), opts);\r\n        // If no match, or no query params, no need to go further\r\n        if (!match || !this.hasQueryParams) {\r\n            return match;\r\n        }\r\n        // Extract query params\r\n        var queryParams = parse(path, options.queryParams);\r\n        var unexpectedQueryParams = Object.keys(queryParams).filter(function (p) { return !_this.isQueryParam(p); });\r\n        if (unexpectedQueryParams.length === 0) {\r\n            // Extend url match\r\n            Object.keys(queryParams).forEach(function (p) { return (match[p] = queryParams[p]); });\r\n            return match;\r\n        }\r\n        return null;\r\n    };\r\n    Path.prototype.partialTest = function (path, opts) {\r\n        var _this = this;\r\n        var options = __assign({ delimited: true, queryParams: {} }, opts);\r\n        // Check if partial match (start of given path matches regex)\r\n        // trailingSlash: falsy => non optional, truthy => optional\r\n        var source = upToDelimiter(this.source, options.delimited);\r\n        var match = this.urlTest(path, source, options);\r\n        if (!match) {\r\n            return match;\r\n        }\r\n        if (!this.hasQueryParams) {\r\n            return match;\r\n        }\r\n        var queryParams = parse(path, options.queryParams);\r\n        Object.keys(queryParams)\r\n            .filter(function (p) { return _this.isQueryParam(p); })\r\n            .forEach(function (p) { return appendQueryParam(match, p, queryParams[p]); });\r\n        return match;\r\n    };\r\n    Path.prototype.build = function (params, opts) {\r\n        var _this = this;\r\n        if (params === void 0) { params = {}; }\r\n        var options = __assign({ ignoreConstraints: false, ignoreSearch: false, queryParams: {} }, opts);\r\n        var encodedUrlParams = Object.keys(params)\r\n            .filter(function (p) { return !_this.isQueryParam(p); })\r\n            .reduce(function (acc, key) {\r\n            if (!exists(params[key])) {\r\n                return acc;\r\n            }\r\n            var val = params[key];\r\n            var encode = _this.isQueryParam(key) ? identity : encodeURI;\r\n            if (typeof val === 'boolean') {\r\n                acc[key] = val;\r\n            }\r\n            else if (Array.isArray(val)) {\r\n                acc[key] = val.map(encode);\r\n            }\r\n            else {\r\n                acc[key] = encode(val);\r\n            }\r\n            return acc;\r\n        }, {});\r\n        // Check all params are provided (not search parameters which are optional)\r\n        if (this.urlParams.some(function (p) { return !exists(params[p]); })) {\r\n            var missingParameters = this.urlParams.filter(function (p) { return !exists(params[p]); });\r\n            throw new Error(\"Cannot build path: '\" +\r\n                this.path +\r\n                \"' requires missing parameters { \" +\r\n                missingParameters.join(', ') +\r\n                ' }');\r\n        }\r\n        // Check constraints\r\n        if (!options.ignoreConstraints) {\r\n            var constraintsPassed = this.tokens\r\n                .filter(function (t) {\r\n                return /^url-parameter/.test(t.type) && !/-splat$/.test(t.type);\r\n            })\r\n                .every(function (t) {\r\n                return new RegExp('^' + defaultOrConstrained(t.otherVal[0]) + '$').test(encodedUrlParams[t.val]);\r\n            });\r\n            if (!constraintsPassed) {\r\n                throw new Error(\"Some parameters of '\" + this.path + \"' are of invalid format\");\r\n            }\r\n        }\r\n        var base = this.tokens\r\n            .filter(function (t) { return /^query-parameter/.test(t.type) === false; })\r\n            .map(function (t) {\r\n            if (t.type === 'url-parameter-matrix') {\r\n                return \";\" + t.val + \"=\" + encodedUrlParams[t.val[0]];\r\n            }\r\n            return /^url-parameter/.test(t.type)\r\n                ? encodedUrlParams[t.val[0]]\r\n                : t.match;\r\n        })\r\n            .join('');\r\n        if (options.ignoreSearch) {\r\n            return base;\r\n        }\r\n        var searchParams = this.queryParams\r\n            .filter(function (p) { return Object.keys(params).indexOf(p) !== -1; })\r\n            .reduce(function (sparams, paramName) {\r\n            sparams[paramName] = params[paramName];\r\n            return sparams;\r\n        }, {});\r\n        var searchPart = build(searchParams, options.queryParams);\r\n        return searchPart ? base + '?' + searchPart : base;\r\n    };\r\n    Path.prototype.getParams = function (type) {\r\n        var predicate = type instanceof RegExp\r\n            ? function (t) { return type.test(t.type); }\r\n            : function (t) { return t.type === type; };\r\n        return this.tokens.filter(predicate).map(function (t) { return t.val[0]; });\r\n    };\r\n    Path.prototype.urlTest = function (path, source, _a) {\r\n        var _this = this;\r\n        var _b = (_a === void 0 ? {} : _a).caseSensitive, caseSensitive = _b === void 0 ? false : _b;\r\n        var regex = new RegExp('^' + source, caseSensitive ? '' : 'i');\r\n        var match = path.match(regex);\r\n        if (!match) {\r\n            return null;\r\n        }\r\n        else if (!this.urlParams.length) {\r\n            return {};\r\n        }\r\n        // Reduce named params to key-value pairs\r\n        return match\r\n            .slice(1, this.urlParams.length + 1)\r\n            .reduce(function (params, m, i) {\r\n            params[_this.urlParams[i]] = decodeURIComponent(m);\r\n            return params;\r\n        }, {});\r\n    };\r\n    return Path;\r\n}());\n\nexport default Path;\nexport { Path };\n","import { build, omit, parse } from 'search-params';\nimport { Path } from 'path-parser';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nvar __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n};\n\nvar getMetaFromSegments = function (segments) {\r\n    var accName = '';\r\n    return segments.reduce(function (meta, segment) {\r\n        var urlParams = segment.parser.urlParams.reduce(function (params, p) {\r\n            params[p] = 'url';\r\n            return params;\r\n        }, {});\r\n        var allParams = segment.parser.queryParams.reduce(function (params, p) {\r\n            params[p] = 'query';\r\n            return params;\r\n        }, urlParams);\r\n        if (segment.name !== undefined) {\r\n            accName = accName ? accName + '.' + segment.name : segment.name;\r\n            meta[accName] = allParams;\r\n        }\r\n        return meta;\r\n    }, {});\r\n};\r\nvar buildStateFromMatch = function (match) {\r\n    if (!match || !match.segments || !match.segments.length) {\r\n        return null;\r\n    }\r\n    var name = match.segments\r\n        .map(function (segment) { return segment.name; })\r\n        .filter(function (name) { return name; })\r\n        .join('.');\r\n    var params = match.params;\r\n    return {\r\n        name: name,\r\n        params: params,\r\n        meta: getMetaFromSegments(match.segments)\r\n    };\r\n};\r\nvar buildPathFromSegments = function (segments, params, options) {\r\n    if (params === void 0) { params = {}; }\r\n    if (options === void 0) { options = {}; }\r\n    if (!segments) {\r\n        return null;\r\n    }\r\n    var _a = options.queryParamsMode, queryParamsMode = _a === void 0 ? 'default' : _a, _b = options.trailingSlashMode;\r\n    var searchParams = [];\r\n    var nonSearchParams = [];\r\n    for (var _i = 0, segments_1 = segments; _i < segments_1.length; _i++) {\r\n        var segment = segments_1[_i];\r\n        var parser = segment.parser;\r\n        searchParams.push.apply(searchParams, parser.queryParams);\r\n        nonSearchParams.push.apply(nonSearchParams, parser.urlParams);\r\n        nonSearchParams.push.apply(nonSearchParams, parser.spatParams);\r\n    }\r\n    if (queryParamsMode === 'loose') {\r\n        var extraParams = Object.keys(params).reduce(function (acc, p) {\r\n            return searchParams.indexOf(p) === -1 &&\r\n                nonSearchParams.indexOf(p) === -1\r\n                ? acc.concat(p)\r\n                : acc;\r\n        }, []);\r\n        searchParams.push.apply(searchParams, extraParams);\r\n    }\r\n    var searchParamsObject = searchParams.reduce(function (acc, paramName) {\r\n        if (Object.keys(params).indexOf(paramName) !== -1) {\r\n            acc[paramName] = params[paramName];\r\n        }\r\n        return acc;\r\n    }, {});\r\n    var searchPart = build(searchParamsObject, options.queryParams);\r\n    var path = segments\r\n        .reduce(function (path, segment) {\r\n        var segmentPath = segment.parser.build(params, {\r\n            ignoreSearch: true,\r\n            queryParams: options.queryParams\r\n        });\r\n        return segment.absolute ? segmentPath : path + segmentPath;\r\n    }, '')\r\n        .replace(/\\/\\/{1,}/g, '/');\r\n    var finalPath = path;\r\n    if (options.trailingSlashMode === 'always') {\r\n        finalPath = /\\/$/.test(path) ? path : path + \"/\";\r\n    }\r\n    else if (options.trailingSlashMode === 'never' && path !== '/') {\r\n        finalPath = /\\/$/.test(path) ? path.slice(0, -1) : path;\r\n    }\r\n    return finalPath + (searchPart ? '?' + searchPart : '');\r\n};\r\nvar getPathFromSegments = function (segments) {\r\n    return segments ? segments.map(function (segment) { return segment.path; }).join('') : null;\r\n};\n\nvar getPath = function (path) { return path.split('?')[0]; };\r\nvar getSearch = function (path) { return path.split('?')[1] || ''; };\r\nvar matchChildren = function (nodes, pathSegment, currentMatch, options, consumedBefore) {\r\n    if (options === void 0) { options = {}; }\r\n    var _a = options.queryParamsMode, queryParamsMode = _a === void 0 ? 'default' : _a, _b = options.strictTrailingSlash, strictTrailingSlash = _b === void 0 ? false : _b, _c = options.strongMatching, strongMatching = _c === void 0 ? true : _c, _d = options.caseSensitive, caseSensitive = _d === void 0 ? false : _d;\r\n    var isRoot = nodes.length === 1 && nodes[0].name === '';\r\n    var _loop_1 = function (child) {\r\n        // Partially match path\r\n        var match;\r\n        var remainingPath = void 0;\r\n        var segment = pathSegment;\r\n        if (consumedBefore === '/' && child.path === '/') {\r\n            // when we encounter repeating slashes we add the slash\r\n            // back to the URL to make it de facto pathless\r\n            segment = '/' + pathSegment;\r\n        }\r\n        if (!child.children.length) {\r\n            match = child.parser.test(segment, {\r\n                caseSensitive: caseSensitive,\r\n                strictTrailingSlash: strictTrailingSlash,\r\n                queryParams: options.queryParams\r\n            });\r\n        }\r\n        if (!match) {\r\n            match = child.parser.partialTest(segment, {\r\n                delimited: strongMatching,\r\n                caseSensitive: caseSensitive,\r\n                queryParams: options.queryParams\r\n            });\r\n        }\r\n        if (match) {\r\n            // Remove consumed segment from path\r\n            var consumedPath = child.parser.build(match, {\r\n                ignoreSearch: true\r\n            });\r\n            if (!strictTrailingSlash && !child.children.length) {\r\n                consumedPath = consumedPath.replace(/\\/$/, '');\r\n            }\r\n            // Can't create a regexp from the path because it might contain a\r\n            // regexp character.\r\n            if (segment.toLowerCase().indexOf(consumedPath.toLowerCase()) === 0) {\r\n                remainingPath = segment.slice(consumedPath.length);\r\n            }\r\n            else {\r\n                remainingPath = segment;\r\n            }\r\n            if (!strictTrailingSlash && !child.children.length) {\r\n                remainingPath = remainingPath.replace(/^\\/\\?/, '?');\r\n            }\r\n            var querystring = omit(getSearch(segment.replace(consumedPath, '')), child.parser.queryParams, options.queryParams).querystring;\r\n            remainingPath =\r\n                getPath(remainingPath) + (querystring ? \"?\" + querystring : '');\r\n            if (!strictTrailingSlash &&\r\n                !isRoot &&\r\n                remainingPath === '/' &&\r\n                !/\\/$/.test(consumedPath)) {\r\n                remainingPath = '';\r\n            }\r\n            currentMatch.segments.push(child);\r\n            Object.keys(match).forEach(function (param) { return (currentMatch.params[param] = match[param]); });\r\n            if (!isRoot && !remainingPath.length) {\r\n                return { value: currentMatch };\r\n            }\r\n            if (!isRoot &&\r\n                queryParamsMode !== 'strict' &&\r\n                remainingPath.indexOf('?') === 0) {\r\n                // unmatched queryParams in non strict mode\r\n                var remainingQueryParams_1 = parse(remainingPath.slice(1), options.queryParams);\r\n                Object.keys(remainingQueryParams_1).forEach(function (name) {\r\n                    return (currentMatch.params[name] = remainingQueryParams_1[name]);\r\n                });\r\n                return { value: currentMatch };\r\n            }\r\n            // Continue matching on non absolute children\r\n            var children = child.getNonAbsoluteChildren();\r\n            // If no children to match against but unmatched path left\r\n            if (!children.length) {\r\n                return { value: null };\r\n            }\r\n            return { value: matchChildren(children, remainingPath, currentMatch, options, consumedPath) };\r\n        }\r\n    };\r\n    // for (child of node.children) {\r\n    for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {\r\n        var child = nodes_1[_i];\r\n        var state_1 = _loop_1(child);\r\n        if (typeof state_1 === \"object\")\r\n            return state_1.value;\r\n    }\r\n    return null;\r\n};\n\nfunction sortChildren(children) {\r\n    var originalChildren = children.slice(0);\r\n    return children.sort(sortPredicate(originalChildren));\r\n}\r\nvar sortPredicate = function (originalChildren) { return function (left, right) {\r\n    var leftPath = left.path\r\n        .replace(/<.*?>/g, '')\r\n        .split('?')[0]\r\n        .replace(/(.+)\\/$/, '$1');\r\n    var rightPath = right.path\r\n        .replace(/<.*?>/g, '')\r\n        .split('?')[0]\r\n        .replace(/(.+)\\/$/, '$1');\r\n    // '/' last\r\n    if (leftPath === '/') {\r\n        return 1;\r\n    }\r\n    if (rightPath === '/') {\r\n        return -1;\r\n    }\r\n    // Spat params last\r\n    if (left.parser.hasSpatParam) {\r\n        return 1;\r\n    }\r\n    if (right.parser.hasSpatParam) {\r\n        return -1;\r\n    }\r\n    // No spat, number of segments (less segments last)\r\n    var leftSegments = (leftPath.match(/\\//g) || []).length;\r\n    var rightSegments = (rightPath.match(/\\//g) || []).length;\r\n    if (leftSegments < rightSegments) {\r\n        return 1;\r\n    }\r\n    if (leftSegments > rightSegments) {\r\n        return -1;\r\n    }\r\n    // Same number of segments, number of URL params ascending\r\n    var leftParamsCount = left.parser.urlParams.length;\r\n    var rightParamsCount = right.parser.urlParams.length;\r\n    if (leftParamsCount < rightParamsCount) {\r\n        return -1;\r\n    }\r\n    if (leftParamsCount > rightParamsCount) {\r\n        return 1;\r\n    }\r\n    // Same number of segments and params, last segment length descending\r\n    var leftParamLength = (leftPath.split('/').slice(-1)[0] || '').length;\r\n    var rightParamLength = (rightPath.split('/').slice(-1)[0] || '').length;\r\n    if (leftParamLength < rightParamLength) {\r\n        return 1;\r\n    }\r\n    if (leftParamLength > rightParamLength) {\r\n        return -1;\r\n    }\r\n    // Same last segment length, preserve definition order. Note that we\r\n    // cannot just return 0, as sort is not guaranteed to be a stable sort.\r\n    return originalChildren.indexOf(left) - originalChildren.indexOf(right);\r\n}; };\n\nvar defaultBuildOptions = {\r\n    queryParamsMode: 'default',\r\n    trailingSlashMode: 'default'\r\n};\r\nvar defaultMatchOptions = __assign({}, defaultBuildOptions, { strongMatching: true });\r\nvar RouteNode = /** @class */ (function () {\r\n    function RouteNode(name, path, childRoutes, cb, parent, finalSort, sort) {\r\n        if (name === void 0) { name = ''; }\r\n        if (path === void 0) { path = ''; }\r\n        if (childRoutes === void 0) { childRoutes = []; }\r\n        if (finalSort === void 0) { finalSort = true; }\r\n        this.name = name;\r\n        this.absolute = /^~/.test(path);\r\n        this.path = this.absolute ? path.slice(1) : path;\r\n        this.parser = this.path ? new Path(this.path) : null;\r\n        this.children = [];\r\n        this.parent = parent;\r\n        this.checkParents();\r\n        this.add(childRoutes, cb, finalSort ? false : sort !== false);\r\n        if (finalSort) {\r\n            this.sortDescendants();\r\n        }\r\n        return this;\r\n    }\r\n    RouteNode.prototype.getParentSegments = function (segments) {\r\n        if (segments === void 0) { segments = []; }\r\n        return this.parent && this.parent.parser\r\n            ? this.parent.getParentSegments(segments.concat(this.parent))\r\n            : segments.reverse();\r\n    };\r\n    RouteNode.prototype.setParent = function (parent) {\r\n        this.parent = parent;\r\n        this.checkParents();\r\n    };\r\n    RouteNode.prototype.setPath = function (path) {\r\n        if (path === void 0) { path = ''; }\r\n        this.path = path;\r\n        this.parser = path ? new Path(path) : null;\r\n    };\r\n    RouteNode.prototype.add = function (route, cb, sort) {\r\n        var _this = this;\r\n        if (sort === void 0) { sort = true; }\r\n        if (route === undefined || route === null) {\r\n            return;\r\n        }\r\n        if (route instanceof Array) {\r\n            route.forEach(function (r) { return _this.add(r, cb, sort); });\r\n            return;\r\n        }\r\n        if (!(route instanceof RouteNode) && !(route instanceof Object)) {\r\n            throw new Error('RouteNode.add() expects routes to be an Object or an instance of RouteNode.');\r\n        }\r\n        else if (route instanceof RouteNode) {\r\n            route.setParent(this);\r\n            this.addRouteNode(route, sort);\r\n        }\r\n        else {\r\n            if (!route.name || !route.path) {\r\n                throw new Error('RouteNode.add() expects routes to have a name and a path defined.');\r\n            }\r\n            var routeNode = new RouteNode(route.name, route.path, route.children, cb, this, false, sort);\r\n            var fullName = routeNode\r\n                .getParentSegments([routeNode])\r\n                .map(function (_) { return _.name; })\r\n                .join('.');\r\n            if (cb) {\r\n                cb(__assign({}, route, { name: fullName }));\r\n            }\r\n            this.addRouteNode(routeNode, sort);\r\n        }\r\n        return this;\r\n    };\r\n    RouteNode.prototype.addNode = function (name, path) {\r\n        this.add(new RouteNode(name, path));\r\n        return this;\r\n    };\r\n    RouteNode.prototype.getPath = function (routeName) {\r\n        return getPathFromSegments(this.getSegmentsByName(routeName));\r\n    };\r\n    RouteNode.prototype.getNonAbsoluteChildren = function () {\r\n        return this.children.filter(function (child) { return !child.absolute; });\r\n    };\r\n    RouteNode.prototype.sortChildren = function () {\r\n        if (this.children.length) {\r\n            sortChildren(this.children);\r\n        }\r\n    };\r\n    RouteNode.prototype.sortDescendants = function () {\r\n        this.sortChildren();\r\n        this.children.forEach(function (child) { return child.sortDescendants(); });\r\n    };\r\n    RouteNode.prototype.buildPath = function (routeName, params, options) {\r\n        if (params === void 0) { params = {}; }\r\n        if (options === void 0) { options = {}; }\r\n        var path = buildPathFromSegments(this.getSegmentsByName(routeName), params, options);\r\n        return path;\r\n    };\r\n    RouteNode.prototype.buildState = function (name, params) {\r\n        if (params === void 0) { params = {}; }\r\n        var segments = this.getSegmentsByName(name);\r\n        if (!segments || !segments.length) {\r\n            return null;\r\n        }\r\n        return {\r\n            name: name,\r\n            params: params,\r\n            meta: getMetaFromSegments(segments)\r\n        };\r\n    };\r\n    RouteNode.prototype.matchPath = function (path, options) {\r\n        if (options === void 0) { options = {}; }\r\n        if (path === '' && !options.strictTrailingSlash) {\r\n            path = '/';\r\n        }\r\n        var match = this.getSegmentsMatchingPath(path, options);\r\n        if (match) {\r\n            var matchedSegments = match.segments;\r\n            if (matchedSegments[0].absolute) {\r\n                var firstSegmentParams = matchedSegments[0].getParentSegments();\r\n                matchedSegments.reverse();\r\n                matchedSegments.push.apply(matchedSegments, firstSegmentParams);\r\n                matchedSegments.reverse();\r\n            }\r\n            var lastSegment = matchedSegments[matchedSegments.length - 1];\r\n            var lastSegmentSlashChild = lastSegment.findSlashChild();\r\n            if (lastSegmentSlashChild) {\r\n                matchedSegments.push(lastSegmentSlashChild);\r\n            }\r\n        }\r\n        return buildStateFromMatch(match);\r\n    };\r\n    RouteNode.prototype.addRouteNode = function (route, sort) {\r\n        if (sort === void 0) { sort = true; }\r\n        var names = route.name.split('.');\r\n        if (names.length === 1) {\r\n            // Check duplicated routes\r\n            if (this.children.map(function (child) { return child.name; }).indexOf(route.name) !==\r\n                -1) {\r\n                throw new Error(\"Alias \\\"\" + route.name + \"\\\" is already defined in route node\");\r\n            }\r\n            // Check duplicated paths\r\n            if (this.children.map(function (child) { return child.path; }).indexOf(route.path) !==\r\n                -1) {\r\n                throw new Error(\"Path \\\"\" + route.path + \"\\\" is already defined in route node\");\r\n            }\r\n            this.children.push(route);\r\n            if (sort) {\r\n                this.sortChildren();\r\n            }\r\n        }\r\n        else {\r\n            // Locate parent node\r\n            var segments = this.getSegmentsByName(names.slice(0, -1).join('.'));\r\n            if (segments) {\r\n                route.name = names[names.length - 1];\r\n                segments[segments.length - 1].add(route);\r\n            }\r\n            else {\r\n                throw new Error(\"Could not add route named '\" + route.name + \"', parent is missing.\");\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    RouteNode.prototype.checkParents = function () {\r\n        if (this.absolute && this.hasParentsParams()) {\r\n            throw new Error('[RouteNode] A RouteNode with an abolute path cannot have parents with route parameters');\r\n        }\r\n    };\r\n    RouteNode.prototype.hasParentsParams = function () {\r\n        if (this.parent && this.parent.parser) {\r\n            var parser = this.parent.parser;\r\n            var hasParams = parser.hasUrlParams ||\r\n                parser.hasSpatParam ||\r\n                parser.hasMatrixParams ||\r\n                parser.hasQueryParams;\r\n            return hasParams || this.parent.hasParentsParams();\r\n        }\r\n        return false;\r\n    };\r\n    RouteNode.prototype.findAbsoluteChildren = function () {\r\n        return this.children.reduce(function (absoluteChildren, child) {\r\n            return absoluteChildren\r\n                .concat(child.absolute ? child : [])\r\n                .concat(child.findAbsoluteChildren());\r\n        }, []);\r\n    };\r\n    RouteNode.prototype.findSlashChild = function () {\r\n        var slashChildren = this.getNonAbsoluteChildren().filter(function (child) { return child.parser && /^\\/(\\?|$)/.test(child.parser.path); });\r\n        return slashChildren[0];\r\n    };\r\n    RouteNode.prototype.getSegmentsByName = function (routeName) {\r\n        var findSegmentByName = function (name, routes) {\r\n            var filteredRoutes = routes.filter(function (r) { return r.name === name; });\r\n            return filteredRoutes.length ? filteredRoutes[0] : undefined;\r\n        };\r\n        var segments = [];\r\n        var routes = this.parser ? [this] : this.children;\r\n        var names = (this.parser ? [''] : []).concat(routeName.split('.'));\r\n        var matched = names.every(function (name) {\r\n            var segment = findSegmentByName(name, routes);\r\n            if (segment) {\r\n                routes = segment.children;\r\n                segments.push(segment);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        return matched ? segments : null;\r\n    };\r\n    RouteNode.prototype.getSegmentsMatchingPath = function (path, options) {\r\n        var topLevelNodes = this.parser ? [this] : this.children;\r\n        var startingNodes = topLevelNodes.reduce(function (nodes, node) { return nodes.concat(node, node.findAbsoluteChildren()); }, []);\r\n        var currentMatch = {\r\n            segments: [],\r\n            params: {}\r\n        };\r\n        var finalMatch = matchChildren(startingNodes, path, currentMatch, options);\r\n        if (finalMatch &&\r\n            finalMatch.segments.length === 1 &&\r\n            finalMatch.segments[0].name === '') {\r\n            return null;\r\n        }\r\n        return finalMatch;\r\n    };\r\n    return RouteNode;\r\n}());\n\nexport default RouteNode;\n","var nameToIDs = function (name) {\r\n    return name\r\n        .split('.')\r\n        .reduce(function (ids, name) {\r\n        return ids.concat(ids.length ? ids[ids.length - 1] + '.' + name : name);\r\n    }, []);\r\n};\r\nvar exists = function (val) { return val !== undefined && val !== null; };\r\nvar hasMetaParams = function (state) { return state && state.meta && state.meta.params; };\r\nvar extractSegmentParams = function (name, state) {\r\n    if (!hasMetaParams(state) || !exists(state.meta.params[name]))\r\n        return {};\r\n    return Object.keys(state.meta.params[name]).reduce(function (params, p) {\r\n        params[p] = state.params[p];\r\n        return params;\r\n    }, {});\r\n};\r\nfunction transitionPath(toState, fromState) {\r\n    var toStateOptions = (toState.meta && toState.meta && toState.meta.options) || {};\r\n    var fromStateIds = fromState ? nameToIDs(fromState.name) : [];\r\n    var toStateIds = nameToIDs(toState.name);\r\n    var maxI = Math.min(fromStateIds.length, toStateIds.length);\r\n    function pointOfDifference() {\r\n        var i;\r\n        var _loop_1 = function () {\r\n            var left = fromStateIds[i];\r\n            var right = toStateIds[i];\r\n            if (left !== right)\r\n                return { value: i };\r\n            var leftParams = extractSegmentParams(left, toState);\r\n            var rightParams = extractSegmentParams(right, fromState);\r\n            if (Object.keys(leftParams).length !==\r\n                Object.keys(rightParams).length)\r\n                return { value: i };\r\n            if (Object.keys(leftParams).length === 0)\r\n                return \"continue\";\r\n            var different = Object.keys(leftParams).some(function (p) { return rightParams[p] !== leftParams[p]; });\r\n            if (different) {\r\n                return { value: i };\r\n            }\r\n        };\r\n        for (i = 0; i < maxI; i += 1) {\r\n            var state_1 = _loop_1();\r\n            if (typeof state_1 === \"object\")\r\n                return state_1.value;\r\n        }\r\n        return i;\r\n    }\r\n    var i;\r\n    if (!fromState || toStateOptions.reload) {\r\n        i = 0;\r\n    }\r\n    else if (!hasMetaParams(fromState) && !hasMetaParams(toState)) {\r\n        i = 0;\r\n    }\r\n    else {\r\n        i = pointOfDifference();\r\n    }\r\n    var toDeactivate = fromStateIds.slice(i).reverse();\r\n    var toActivate = toStateIds.slice(i);\r\n    var intersection = fromState && i > 0 ? fromStateIds[i - 1] : '';\r\n    return {\r\n        intersection: intersection,\r\n        toDeactivate: toDeactivate,\r\n        toActivate: toActivate\r\n    };\r\n}\n\nfunction shouldUpdateNode(nodeName) {\r\n    return function (toState, fromSate) {\r\n        var _a = transitionPath(toState, fromSate), intersection = _a.intersection, toActivate = _a.toActivate, toDeactivateReversed = _a.toDeactivate;\r\n        var toDeactivate = toDeactivateReversed.slice().reverse();\r\n        if (toState.meta.options && toState.meta.options.reload) {\r\n            return true;\r\n        }\r\n        if (nodeName === intersection) {\r\n            return true;\r\n        }\r\n        if (toActivate.indexOf(nodeName) === -1) {\r\n            return false;\r\n        }\r\n        var matching = true;\r\n        for (var i = 0; i < toActivate.length; i += 1) {\r\n            var activatedSegment = toActivate[i];\r\n            var sameLevelDeactivatedSegment = toDeactivate[i];\r\n            matching = activatedSegment === sameLevelDeactivatedSegment;\r\n            if (matching && activatedSegment === nodeName) {\r\n                return true;\r\n            }\r\n            if (!matching) {\r\n                return false;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n}\n\nexport default transitionPath;\nexport { shouldUpdateNode, nameToIDs };\n","import $$observable from 'symbol-observable';\nimport RouteNode from 'route-node';\nexport { default as RouteNode } from 'route-node';\nimport transitionPath, { nameToIDs } from 'router5-transition-path';\nexport { default as transitionPath } from 'router5-transition-path';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar defaultOptions = {\r\n    trailingSlashMode: 'default',\r\n    queryParamsMode: 'default',\r\n    strictTrailingSlash: false,\r\n    autoCleanUp: true,\r\n    allowNotFound: false,\r\n    strongMatching: true,\r\n    rewritePathOnMatch: true,\r\n    caseSensitive: false\r\n};\r\nfunction withOptions(options) {\r\n    return function (router) {\r\n        var routerOptions = __assign({}, defaultOptions, options);\r\n        router.getOptions = function () { return routerOptions; };\r\n        router.setOption = function (option, value) {\r\n            routerOptions[option] = value;\r\n            return router;\r\n        };\r\n        return router;\r\n    };\r\n}\n\nvar errorCodes = {\r\n    ROUTER_NOT_STARTED: 'NOT_STARTED',\r\n    NO_START_PATH_OR_STATE: 'NO_START_PATH_OR_STATE',\r\n    ROUTER_ALREADY_STARTED: 'ALREADY_STARTED',\r\n    ROUTE_NOT_FOUND: 'ROUTE_NOT_FOUND',\r\n    SAME_STATES: 'SAME_STATES',\r\n    CANNOT_DEACTIVATE: 'CANNOT_DEACTIVATE',\r\n    CANNOT_ACTIVATE: 'CANNOT_ACTIVATE',\r\n    TRANSITION_ERR: 'TRANSITION_ERR',\r\n    TRANSITION_CANCELLED: 'CANCELLED'\r\n};\r\nvar constants = {\r\n    UNKNOWN_ROUTE: '@@router5/UNKNOWN_ROUTE',\r\n    ROUTER_START: '$start',\r\n    ROUTER_STOP: '$stop',\r\n    TRANSITION_START: '$$start',\r\n    TRANSITION_CANCEL: '$$cancel',\r\n    TRANSITION_SUCCESS: '$$success',\r\n    TRANSITION_ERROR: '$$error'\r\n};\n\nfunction withRoutes(routes) {\r\n    return function (router) {\r\n        router.forward = function (fromRoute, toRoute) {\r\n            router.config.forwardMap[fromRoute] = toRoute;\r\n            return router;\r\n        };\r\n        var rootNode = routes instanceof RouteNode\r\n            ? routes\r\n            : new RouteNode('', '', routes, onRouteAdded);\r\n        function onRouteAdded(route) {\r\n            if (route.canActivate)\r\n                router.canActivate(route.name, route.canActivate);\r\n            if (route.forwardTo)\r\n                router.forward(route.name, route.forwardTo);\r\n            if (route.decodeParams)\r\n                router.config.decoders[route.name] = route.decodeParams;\r\n            if (route.encodeParams)\r\n                router.config.encoders[route.name] = route.encodeParams;\r\n            if (route.defaultParams)\r\n                router.config.defaultParams[route.name] = route.defaultParams;\r\n        }\r\n        router.rootNode = rootNode;\r\n        router.add = function (routes, finalSort) {\r\n            rootNode.add(routes, onRouteAdded, !finalSort);\r\n            if (finalSort) {\r\n                rootNode.sortDescendants();\r\n            }\r\n            return router;\r\n        };\r\n        router.addNode = function (name, path, canActivateHandler) {\r\n            rootNode.addNode(name, path);\r\n            if (canActivateHandler)\r\n                router.canActivate(name, canActivateHandler);\r\n            return router;\r\n        };\r\n        router.isActive = function (name, params, strictEquality, ignoreQueryParams) {\r\n            if (params === void 0) { params = {}; }\r\n            if (strictEquality === void 0) { strictEquality = false; }\r\n            if (ignoreQueryParams === void 0) { ignoreQueryParams = true; }\r\n            var activeState = router.getState();\r\n            if (!activeState)\r\n                return false;\r\n            if (strictEquality || activeState.name === name) {\r\n                return router.areStatesEqual(router.makeState(name, params), activeState, ignoreQueryParams);\r\n            }\r\n            return router.areStatesDescendants(router.makeState(name, params), activeState);\r\n        };\r\n        router.buildPath = function (route, params) {\r\n            if (route === constants.UNKNOWN_ROUTE) {\r\n                return params.path;\r\n            }\r\n            var paramsWithDefault = __assign({}, router.config.defaultParams[route], params);\r\n            var _a = router.getOptions(), trailingSlashMode = _a.trailingSlashMode, queryParamsMode = _a.queryParamsMode, queryParams = _a.queryParams;\r\n            var encodedParams = router.config.encoders[route]\r\n                ? router.config.encoders[route](paramsWithDefault)\r\n                : paramsWithDefault;\r\n            return router.rootNode.buildPath(route, encodedParams, {\r\n                trailingSlashMode: trailingSlashMode,\r\n                queryParamsMode: queryParamsMode,\r\n                queryParams: queryParams\r\n            });\r\n        };\r\n        router.matchPath = function (path, source) {\r\n            var options = router.getOptions();\r\n            var match = router.rootNode.matchPath(path, options);\r\n            if (match) {\r\n                var name_1 = match.name, params = match.params, meta = match.meta;\r\n                var decodedParams = router.config.decoders[name_1]\r\n                    ? router.config.decoders[name_1](params)\r\n                    : params;\r\n                var _a = router.forwardState(name_1, decodedParams), routeName = _a.name, routeParams = _a.params;\r\n                var builtPath = options.rewritePathOnMatch === false\r\n                    ? path\r\n                    : router.buildPath(routeName, routeParams);\r\n                return router.makeState(routeName, routeParams, builtPath, {\r\n                    params: meta,\r\n                    source: source\r\n                });\r\n            }\r\n            return null;\r\n        };\r\n        router.setRootPath = function (rootPath) {\r\n            router.rootNode.setPath(rootPath);\r\n        };\r\n        return router;\r\n    };\r\n}\n\nfunction withDependencies(dependencies) {\r\n    return function (router) {\r\n        var routerDependencies = dependencies;\r\n        router.setDependency = function (dependencyName, dependency) {\r\n            routerDependencies[dependencyName] = dependency;\r\n            return router;\r\n        };\r\n        router.setDependencies = function (deps) {\r\n            Object.keys(deps).forEach(function (name) {\r\n                return router.setDependency(name, deps[name]);\r\n            });\r\n            return router;\r\n        };\r\n        router.getDependencies = function () { return routerDependencies; };\r\n        router.getInjectables = function () { return [router, router.getDependencies()]; };\r\n        router.executeFactory = function (factoryFunction) {\r\n            return factoryFunction.apply(void 0, router.getInjectables());\r\n        };\r\n        return router;\r\n    };\r\n}\n\nfunction withState(router) {\r\n    var stateId = 0;\r\n    var routerState = null;\r\n    router.getState = function () { return routerState; };\r\n    router.setState = function (state) {\r\n        routerState = state;\r\n    };\r\n    router.makeState = function (name, params, path, meta, forceId) { return ({\r\n        name: name,\r\n        params: __assign({}, router.config.defaultParams[name], params),\r\n        path: path,\r\n        meta: meta\r\n            ? __assign({}, meta, { id: forceId === undefined ? ++stateId : forceId }) : undefined\r\n    }); };\r\n    router.makeNotFoundState = function (path, options) {\r\n        return router.makeState(constants.UNKNOWN_ROUTE, { path: path }, path, {\r\n            options: options\r\n        });\r\n    };\r\n    router.areStatesEqual = function (state1, state2, ignoreQueryParams) {\r\n        if (ignoreQueryParams === void 0) { ignoreQueryParams = true; }\r\n        if (state1.name !== state2.name)\r\n            return false;\r\n        var getUrlParams = function (name) {\r\n            return router.rootNode\r\n                //@ts-ignore\r\n                .getSegmentsByName(name)\r\n                .map(function (segment) { return segment.parser['urlParams']; })\r\n                .reduce(function (params, p) { return params.concat(p); }, []);\r\n        };\r\n        var state1Params = ignoreQueryParams\r\n            ? getUrlParams(state1.name)\r\n            : Object.keys(state1.params);\r\n        var state2Params = ignoreQueryParams\r\n            ? getUrlParams(state2.name)\r\n            : Object.keys(state2.params);\r\n        return (state1Params.length === state2Params.length &&\r\n            state1Params.every(function (p) { return state1.params[p] === state2.params[p]; }));\r\n    };\r\n    router.areStatesDescendants = function (parentState, childState) {\r\n        var regex = new RegExp('^' + parentState.name + '\\\\.(.*)$');\r\n        if (!regex.test(childState.name))\r\n            return false;\r\n        // If child state name extends parent state name, and all parent state params\r\n        // are in child state params.\r\n        return Object.keys(parentState.params).every(function (p) { return parentState.params[p] === childState.params[p]; });\r\n    };\r\n    router.forwardState = function (routeName, routeParams) {\r\n        var name = router.config.forwardMap[routeName] || routeName;\r\n        var params = __assign({}, router.config.defaultParams[routeName], router.config.defaultParams[name], routeParams);\r\n        return {\r\n            name: name,\r\n            params: params\r\n        };\r\n    };\r\n    router.buildState = function (routeName, routeParams) {\r\n        var _a = router.forwardState(routeName, routeParams), name = _a.name, params = _a.params;\r\n        return router.rootNode.buildState(name, params);\r\n    };\r\n    return router;\r\n}\n\nvar eventsMap = {\r\n    onStart: constants.ROUTER_START,\r\n    onStop: constants.ROUTER_STOP,\r\n    onTransitionSuccess: constants.TRANSITION_SUCCESS,\r\n    onTransitionStart: constants.TRANSITION_START,\r\n    onTransitionError: constants.TRANSITION_ERROR,\r\n    onTransitionCancel: constants.TRANSITION_CANCEL\r\n};\r\nfunction withPlugins(router) {\r\n    var routerPlugins = [];\r\n    router.getPlugins = function () { return routerPlugins; };\r\n    router.usePlugin = function () {\r\n        var plugins = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            plugins[_i] = arguments[_i];\r\n        }\r\n        var removePluginFns = plugins.map(function (plugin) {\r\n            routerPlugins.push(plugin);\r\n            return startPlugin(plugin);\r\n        });\r\n        return function () {\r\n            routerPlugins = routerPlugins.filter(function (plugin) { return plugins.indexOf(plugin) === -1; });\r\n            removePluginFns.forEach(function (removePlugin) { return removePlugin(); });\r\n        };\r\n    };\r\n    function startPlugin(plugin) {\r\n        var appliedPlugin = router.executeFactory(plugin);\r\n        var removeEventListeners = Object.keys(eventsMap)\r\n            .map(function (methodName) {\r\n            if (appliedPlugin[methodName]) {\r\n                return router.addEventListener(eventsMap[methodName], appliedPlugin[methodName]);\r\n            }\r\n        })\r\n            .filter(Boolean);\r\n        return function () {\r\n            removeEventListeners.forEach(function (removeListener) { return removeListener(); });\r\n            if (appliedPlugin.teardown) {\r\n                appliedPlugin.teardown();\r\n            }\r\n        };\r\n    }\r\n    return router;\r\n}\n\nfunction withMiddleware(router) {\r\n    var middlewareFactories = [];\r\n    var middlewareFunctions = [];\r\n    router.useMiddleware = function () {\r\n        var middlewares = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            middlewares[_i] = arguments[_i];\r\n        }\r\n        var removePluginFns = middlewares.map(function (middleware) {\r\n            var middlewareFunction = router.executeFactory(middleware);\r\n            middlewareFactories.push(middleware);\r\n            middlewareFunctions.push(middlewareFunction);\r\n            return function () {\r\n                middlewareFactories = middlewareFactories.filter(function (m) { return m !== middleware; });\r\n                middlewareFunctions = middlewareFunctions.filter(function (m) { return m !== middlewareFunction; });\r\n            };\r\n        });\r\n        return function () { return removePluginFns.forEach(function (fn) { return fn(); }); };\r\n    };\r\n    router.clearMiddleware = function () {\r\n        middlewareFactories = [];\r\n        middlewareFunctions = [];\r\n        return router;\r\n    };\r\n    router.getMiddlewareFactories = function () { return middlewareFactories; };\r\n    router.getMiddlewareFunctions = function () { return middlewareFunctions; };\r\n    return router;\r\n}\n\nfunction withObservability(router) {\r\n    var callbacks = {};\r\n    router.invokeEventListeners = function (eventName) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        (callbacks[eventName] || []).forEach(function (cb) { return cb.apply(void 0, args); });\r\n    };\r\n    router.removeEventListener = function (eventName, cb) {\r\n        callbacks[eventName] = callbacks[eventName].filter(function (_cb) { return _cb !== cb; });\r\n    };\r\n    router.addEventListener = function (eventName, cb) {\r\n        callbacks[eventName] = (callbacks[eventName] || []).concat(cb);\r\n        return function () { return router.removeEventListener(eventName, cb); };\r\n    };\r\n    function subscribe(listener) {\r\n        var isObject = typeof listener === 'object';\r\n        var finalListener = isObject ? listener.next.bind(listener) : listener;\r\n        var unsubscribeHandler = router.addEventListener(constants.TRANSITION_SUCCESS, function (toState, fromState) {\r\n            finalListener({\r\n                route: toState,\r\n                previousRoute: fromState\r\n            });\r\n        });\r\n        return isObject\r\n            ? { unsubscribe: unsubscribeHandler }\r\n            : unsubscribeHandler;\r\n    }\r\n    function observable() {\r\n        var _a;\r\n        return _a = {\r\n                subscribe: function (observer) {\r\n                    if (typeof observer !== 'object' || observer === null) {\r\n                        throw new TypeError('Expected the observer to be an object.');\r\n                    }\r\n                    return subscribe(observer);\r\n                }\r\n            },\r\n            _a[$$observable] = function () {\r\n                return this;\r\n            },\r\n            _a;\r\n    }\r\n    router.subscribe = subscribe;\r\n    //@ts-ignore\r\n    router[$$observable] = observable;\r\n    //@ts-ignore\r\n    router['@@observable'] = observable;\r\n    return router;\r\n}\n\nfunction resolve(functions, _a, callback) {\r\n    var isCancelled = _a.isCancelled, toState = _a.toState, fromState = _a.fromState, _b = _a.errorKey, errorKey = _b === void 0 ? undefined : _b;\r\n    var remainingFunctions = Array.isArray(functions)\r\n        ? functions\r\n        : Object.keys(functions);\r\n    var isState = function (obj) {\r\n        return typeof obj === 'object' &&\r\n            obj.name !== undefined &&\r\n            obj.params !== undefined &&\r\n            obj.path !== undefined;\r\n    };\r\n    var hasStateChanged = function (toState, fromState) {\r\n        return fromState.name !== toState.name ||\r\n            fromState.params !== toState.params ||\r\n            fromState.path !== toState.path;\r\n    };\r\n    var mergeStates = function (toState, fromState) { return (__assign({}, fromState, toState, { meta: __assign({}, fromState.meta, toState.meta) })); };\r\n    var processFn = function (stepFn, errBase, state, _done) {\r\n        var done = function (err, newState) {\r\n            if (err) {\r\n                _done(err);\r\n            }\r\n            else if (newState && newState !== state && isState(newState)) {\r\n                if (hasStateChanged(newState, state)) {\r\n                    console.error('[router5][transition] Warning: state values (name, params, path) were changed during transition process.');\r\n                }\r\n                _done(null, mergeStates(newState, state));\r\n            }\r\n            else {\r\n                _done(null, state);\r\n            }\r\n        };\r\n        var res = stepFn.call(null, state, fromState, done);\r\n        if (isCancelled()) {\r\n            done(null);\r\n        }\r\n        else if (typeof res === 'boolean') {\r\n            done(res ? null : errBase);\r\n        }\r\n        else if (isState(res)) {\r\n            done(null, res);\r\n        }\r\n        else if (res && typeof res.then === 'function') {\r\n            res.then(function (resVal) {\r\n                if (resVal instanceof Error)\r\n                    done({ error: resVal }, null);\r\n                else\r\n                    done(null, resVal);\r\n            }, function (err) {\r\n                if (err instanceof Error) {\r\n                    console.error(err.stack || err);\r\n                    done(__assign({}, errBase, { promiseError: err }), null);\r\n                }\r\n                else {\r\n                    done(typeof err === 'object'\r\n                        ? __assign({}, errBase, err) : errBase, null);\r\n                }\r\n            });\r\n        }\r\n        // else: wait for done to be called\r\n    };\r\n    var next = function (err, state) {\r\n        var _a;\r\n        if (isCancelled()) {\r\n            callback();\r\n        }\r\n        else if (err) {\r\n            callback(err);\r\n        }\r\n        else {\r\n            if (!remainingFunctions.length) {\r\n                callback(null, state);\r\n            }\r\n            else {\r\n                var isMapped = typeof remainingFunctions[0] === 'string';\r\n                var errBase = errorKey && isMapped\r\n                    ? (_a = {}, _a[errorKey] = remainingFunctions[0], _a) : {};\r\n                var stepFn = isMapped\r\n                    ? functions[remainingFunctions[0]]\r\n                    : remainingFunctions[0];\r\n                remainingFunctions = remainingFunctions.slice(1);\r\n                processFn(stepFn, errBase, state, next);\r\n            }\r\n        }\r\n    };\r\n    next(null, toState);\r\n}\n\nfunction transition(router, toState, fromState, opts, callback) {\r\n    var cancelled = false;\r\n    var completed = false;\r\n    var options = router.getOptions();\r\n    var _a = router.getLifecycleFunctions(), canDeactivateFunctions = _a[0], canActivateFunctions = _a[1];\r\n    var middlewareFunctions = router.getMiddlewareFunctions();\r\n    var isCancelled = function () { return cancelled; };\r\n    var cancel = function () {\r\n        if (!cancelled && !completed) {\r\n            cancelled = true;\r\n            callback({ code: errorCodes.TRANSITION_CANCELLED }, null);\r\n        }\r\n    };\r\n    var done = function (err, state) {\r\n        completed = true;\r\n        if (isCancelled()) {\r\n            return;\r\n        }\r\n        if (!err && options.autoCleanUp) {\r\n            var activeSegments_1 = nameToIDs(toState.name);\r\n            Object.keys(canDeactivateFunctions).forEach(function (name) {\r\n                if (activeSegments_1.indexOf(name) === -1)\r\n                    router.clearCanDeactivate(name);\r\n            });\r\n        }\r\n        callback(err, state || toState);\r\n    };\r\n    var makeError = function (base, err) { return (__assign({}, base, (err instanceof Object ? err : { error: err }))); };\r\n    var isUnknownRoute = toState.name === constants.UNKNOWN_ROUTE;\r\n    var asyncBase = { isCancelled: isCancelled, toState: toState, fromState: fromState };\r\n    var _b = transitionPath(toState, fromState), toDeactivate = _b.toDeactivate, toActivate = _b.toActivate;\r\n    var canDeactivate = !fromState || opts.forceDeactivate\r\n        ? []\r\n        : function (toState, fromState, cb) {\r\n            var canDeactivateFunctionMap = toDeactivate\r\n                .filter(function (name) { return canDeactivateFunctions[name]; })\r\n                .reduce(function (fnMap, name) {\r\n                var _a;\r\n                return (__assign({}, fnMap, (_a = {}, _a[name] = canDeactivateFunctions[name], _a)));\r\n            }, {});\r\n            resolve(canDeactivateFunctionMap, __assign({}, asyncBase, { errorKey: 'segment' }), function (err) {\r\n                return cb(err\r\n                    ? makeError({ code: errorCodes.CANNOT_DEACTIVATE }, err)\r\n                    : null);\r\n            });\r\n        };\r\n    var canActivate = isUnknownRoute\r\n        ? []\r\n        : function (toState, fromState, cb) {\r\n            var canActivateFunctionMap = toActivate\r\n                .filter(function (name) { return canActivateFunctions[name]; })\r\n                .reduce(function (fnMap, name) {\r\n                var _a;\r\n                return (__assign({}, fnMap, (_a = {}, _a[name] = canActivateFunctions[name], _a)));\r\n            }, {});\r\n            resolve(canActivateFunctionMap, __assign({}, asyncBase, { errorKey: 'segment' }), function (err) {\r\n                return cb(err\r\n                    ? makeError({ code: errorCodes.CANNOT_ACTIVATE }, err)\r\n                    : null);\r\n            });\r\n        };\r\n    var middleware = !middlewareFunctions.length\r\n        ? []\r\n        : function (toState, fromState, cb) {\r\n            return resolve(middlewareFunctions, __assign({}, asyncBase), function (err, state) {\r\n                return cb(err\r\n                    ? makeError({ code: errorCodes.TRANSITION_ERR }, err)\r\n                    : null, state || toState);\r\n            });\r\n        };\r\n    var pipeline = []\r\n        .concat(canDeactivate)\r\n        .concat(canActivate)\r\n        .concat(middleware);\r\n    resolve(pipeline, asyncBase, done);\r\n    return cancel;\r\n}\n\nvar noop = function (err, state) { };\r\nfunction withNavigation(router) {\r\n    var cancelCurrentTransition;\r\n    router.navigate = navigate;\r\n    router.navigate = navigate;\r\n    router.navigateToDefault = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var opts = typeof args[0] === 'object' ? args[0] : {};\r\n        var done = args.length === 2\r\n            ? args[1]\r\n            : typeof args[0] === 'function'\r\n                ? args[0]\r\n                : noop;\r\n        var options = router.getOptions();\r\n        if (options.defaultRoute) {\r\n            return navigate(options.defaultRoute, options.defaultParams, opts, done);\r\n        }\r\n        return function () { };\r\n    };\r\n    router.cancel = function () {\r\n        if (cancelCurrentTransition) {\r\n            cancelCurrentTransition('navigate');\r\n            cancelCurrentTransition = null;\r\n        }\r\n        return router;\r\n    };\r\n    function navigate() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var name = args[0];\r\n        var lastArg = args[args.length - 1];\r\n        var done = typeof lastArg === 'function' ? lastArg : noop;\r\n        var params = typeof args[1] === 'object' ? args[1] : {};\r\n        var opts = typeof args[2] === 'object' ? args[2] : {};\r\n        if (!router.isStarted()) {\r\n            done({ code: errorCodes.ROUTER_NOT_STARTED });\r\n            return;\r\n        }\r\n        var route = router.buildState(name, params);\r\n        if (!route) {\r\n            var err = { code: errorCodes.ROUTE_NOT_FOUND };\r\n            done(err);\r\n            router.invokeEventListeners(constants.TRANSITION_ERROR, null, router.getState(), err);\r\n            return;\r\n        }\r\n        var toState = router.makeState(route.name, route.params, router.buildPath(route.name, route.params), { params: route.meta, options: opts });\r\n        var sameStates = router.getState()\r\n            ? router.areStatesEqual(router.getState(), toState, false)\r\n            : false;\r\n        // Do not proceed further if states are the same and no reload\r\n        // (no deactivation and no callbacks)\r\n        if (sameStates && !opts.reload && !opts.force) {\r\n            var err = { code: errorCodes.SAME_STATES };\r\n            done(err);\r\n            router.invokeEventListeners(constants.TRANSITION_ERROR, toState, router.getState(), err);\r\n            return;\r\n        }\r\n        var fromState = router.getState();\r\n        if (opts.skipTransition) {\r\n            done(null, toState);\r\n            return noop;\r\n        }\r\n        // Transition\r\n        return router.transitionToState(toState, fromState, opts, function (err, state) {\r\n            if (err) {\r\n                if (err.redirect) {\r\n                    var _a = err.redirect, name_1 = _a.name, params_1 = _a.params;\r\n                    navigate(name_1, params_1, __assign({}, opts, { force: true, redirected: true }), done);\r\n                }\r\n                else {\r\n                    done(err);\r\n                }\r\n            }\r\n            else {\r\n                router.invokeEventListeners(constants.TRANSITION_SUCCESS, state, fromState, opts);\r\n                done(null, state);\r\n            }\r\n        });\r\n    }\r\n    router.transitionToState = function (toState, fromState, options, done) {\r\n        if (options === void 0) { options = {}; }\r\n        if (done === void 0) { done = noop; }\r\n        router.cancel();\r\n        router.invokeEventListeners(constants.TRANSITION_START, toState, fromState);\r\n        cancelCurrentTransition = transition(router, toState, fromState, options, function (err, state) {\r\n            cancelCurrentTransition = null;\r\n            state = state || toState;\r\n            if (err) {\r\n                if (err.code === errorCodes.TRANSITION_CANCELLED) {\r\n                    router.invokeEventListeners(constants.TRANSITION_CANCEL, toState, fromState);\r\n                }\r\n                else {\r\n                    router.invokeEventListeners(constants.TRANSITION_ERROR, toState, fromState, err);\r\n                }\r\n                done(err);\r\n            }\r\n            else {\r\n                router.setState(state);\r\n                done(null, state);\r\n            }\r\n        });\r\n        return cancelCurrentTransition;\r\n    };\r\n    return router;\r\n}\n\nvar noop$1 = function () { };\r\nfunction withRouterLifecycle(router) {\r\n    var started = false;\r\n    router.isStarted = function () { return started; };\r\n    //@ts-ignore\r\n    router.start = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var options = router.getOptions();\r\n        var lastArg = args[args.length - 1];\r\n        var done = typeof lastArg === 'function' ? lastArg : noop$1;\r\n        var startPathOrState = typeof args[0] !== 'function' ? args[0] : undefined;\r\n        if (started) {\r\n            done({ code: errorCodes.ROUTER_ALREADY_STARTED });\r\n            return router;\r\n        }\r\n        var startPath, startState;\r\n        started = true;\r\n        router.invokeEventListeners(constants.ROUTER_START);\r\n        // callback\r\n        var cb = function (err, state, invokeErrCb) {\r\n            if (invokeErrCb === void 0) { invokeErrCb = true; }\r\n            if (!err)\r\n                router.invokeEventListeners(constants.TRANSITION_SUCCESS, state, null, { replace: true });\r\n            if (err && invokeErrCb)\r\n                router.invokeEventListeners(constants.TRANSITION_ERROR, state, null, err);\r\n            done(err, state);\r\n        };\r\n        if (startPathOrState === undefined && !options.defaultRoute) {\r\n            return cb({ code: errorCodes.NO_START_PATH_OR_STATE });\r\n        }\r\n        if (typeof startPathOrState === 'string') {\r\n            startPath = startPathOrState;\r\n        }\r\n        else if (typeof startPathOrState === 'object') {\r\n            startState = startPathOrState;\r\n        }\r\n        if (!startState) {\r\n            // If no supplied start state, get start state\r\n            startState =\r\n                startPath === undefined ? null : router.matchPath(startPath);\r\n            // Navigate to default function\r\n            var navigateToDefault_1 = function () {\r\n                return router.navigateToDefault({ replace: true }, done);\r\n            };\r\n            var redirect_1 = function (route) {\r\n                return router.navigate(route.name, route.params, { replace: true, reload: true, redirected: true }, done);\r\n            };\r\n            var transitionToState = function (state) {\r\n                router.transitionToState(state, router.getState(), {}, function (err, state) {\r\n                    if (!err)\r\n                        cb(null, state);\r\n                    else if (err.redirect)\r\n                        redirect_1(err.redirect);\r\n                    else if (options.defaultRoute)\r\n                        navigateToDefault_1();\r\n                    else\r\n                        cb(err, null, false);\r\n                });\r\n            };\r\n            // If matched start path\r\n            if (startState) {\r\n                transitionToState(startState);\r\n            }\r\n            else if (options.defaultRoute) {\r\n                // If default, navigate to default\r\n                navigateToDefault_1();\r\n            }\r\n            else if (options.allowNotFound) {\r\n                transitionToState(router.makeNotFoundState(startPath, { replace: true }));\r\n            }\r\n            else {\r\n                // No start match, no default => do nothing\r\n                cb({ code: errorCodes.ROUTE_NOT_FOUND, path: startPath }, null);\r\n            }\r\n        }\r\n        else {\r\n            // Initialise router with provided start state\r\n            router.setState(startState);\r\n            cb(null, startState);\r\n        }\r\n        return router;\r\n    };\r\n    router.stop = function () {\r\n        if (started) {\r\n            router.setState(null);\r\n            started = false;\r\n            router.invokeEventListeners(constants.ROUTER_STOP);\r\n        }\r\n        return router;\r\n    };\r\n    return router;\r\n}\n\nvar toFunction = function (val) { return (typeof val === 'function' ? val : function () { return function () { return val; }; }); };\r\nfunction withRouteLifecycle(router) {\r\n    var canDeactivateFactories = {};\r\n    var canActivateFactories = {};\r\n    var canDeactivateFunctions = {};\r\n    var canActivateFunctions = {};\r\n    router.getLifecycleFactories = function () {\r\n        return [canDeactivateFactories, canActivateFactories];\r\n    };\r\n    router.getLifecycleFunctions = function () {\r\n        return [canDeactivateFunctions, canActivateFunctions];\r\n    };\r\n    router.canDeactivate = function (name, canDeactivateHandler) {\r\n        var factory = toFunction(canDeactivateHandler);\r\n        canDeactivateFactories[name] = factory;\r\n        canDeactivateFunctions[name] = router.executeFactory(factory);\r\n        return router;\r\n    };\r\n    router.clearCanDeactivate = function (name) {\r\n        canDeactivateFactories[name] = undefined;\r\n        canDeactivateFunctions[name] = undefined;\r\n        return router;\r\n    };\r\n    router.canActivate = function (name, canActivateHandler) {\r\n        var factory = toFunction(canActivateHandler);\r\n        canActivateFactories[name] = factory;\r\n        canActivateFunctions[name] = router.executeFactory(factory);\r\n        return router;\r\n    };\r\n    return router;\r\n}\n\nvar pipe = function () {\r\n    var fns = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        fns[_i] = arguments[_i];\r\n    }\r\n    return function (arg) {\r\n        return fns.reduce(function (prev, fn) { return fn(prev); }, arg);\r\n    };\r\n};\r\nvar createRouter = function (routes, options, dependencies) {\r\n    if (routes === void 0) { routes = []; }\r\n    if (options === void 0) { options = {}; }\r\n    if (dependencies === void 0) { dependencies = {}; }\r\n    var config = {\r\n        decoders: {},\r\n        encoders: {},\r\n        defaultParams: {},\r\n        forwardMap: {}\r\n    };\r\n    return pipe(withOptions(options), withDependencies(dependencies), withObservability, withState, withRouterLifecycle, withRouteLifecycle, withNavigation, withPlugins, withMiddleware, withRoutes(routes))({ config: config });\r\n};\n\nfunction cloneRouter(router, dependencies) {\r\n    var clonedRouter = createRouter(router.rootNode, router.getOptions(), dependencies);\r\n    clonedRouter.useMiddleware.apply(clonedRouter, router.getMiddlewareFactories());\r\n    clonedRouter.usePlugin.apply(clonedRouter, router.getPlugins());\r\n    clonedRouter.config = router.config;\r\n    var _a = router.getLifecycleFactories(), canDeactivateFactories = _a[0], canActivateFactories = _a[1];\r\n    Object.keys(canDeactivateFactories).forEach(function (name) {\r\n        return clonedRouter.canDeactivate(name, canDeactivateFactories[name]);\r\n    });\r\n    Object.keys(canActivateFactories).forEach(function (name) {\r\n        return clonedRouter.canActivate(name, canActivateFactories[name]);\r\n    });\r\n    return clonedRouter;\r\n}\n\nexport default createRouter;\nexport { createRouter, cloneRouter, constants, errorCodes };\n","import { errorCodes, constants } from 'router5';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar value = function (arg) { return function () { return arg; }; };\r\nvar noop = function () { };\r\nvar isBrowser = typeof window !== 'undefined' && window.history;\r\nvar getBase = function () { return window.location.pathname; };\r\nvar supportsPopStateOnHashChange = function () {\r\n    return window.navigator.userAgent.indexOf('Trident') === -1;\r\n};\r\nvar pushState = function (state, title, path) {\r\n    return window.history.pushState(state, title, path);\r\n};\r\nvar replaceState = function (state, title, path) {\r\n    return window.history.replaceState(state, title, path);\r\n};\r\nvar addPopstateListener = function (fn, opts) {\r\n    var shouldAddHashChangeListener = opts.useHash && !supportsPopStateOnHashChange();\r\n    window.addEventListener('popstate', fn);\r\n    if (shouldAddHashChangeListener) {\r\n        window.addEventListener('hashchange', fn);\r\n    }\r\n    return function () {\r\n        window.removeEventListener('popstate', fn);\r\n        if (shouldAddHashChangeListener) {\r\n            window.removeEventListener('hashchange', fn);\r\n        }\r\n    };\r\n};\r\nvar getLocation = function (opts) {\r\n    var path = opts.useHash\r\n        ? window.location.hash.replace(new RegExp('^#' + opts.hashPrefix), '')\r\n        : window.location.pathname.replace(new RegExp('^' + opts.base), '');\r\n    // Fix issue with browsers that don't URL encode characters (Edge)\r\n    var correctedPath = safelyEncodePath(path);\r\n    return (correctedPath || '/') + window.location.search;\r\n};\r\nvar safelyEncodePath = function (path) {\r\n    try {\r\n        return encodeURI(decodeURI(path));\r\n    }\r\n    catch (_) {\r\n        return path;\r\n    }\r\n};\r\nvar getState = function () { return window.history.state; };\r\nvar getHash = function () { return window.location.hash; };\r\nvar browser = {};\r\nif (isBrowser) {\r\n    browser = {\r\n        getBase: getBase,\r\n        pushState: pushState,\r\n        replaceState: replaceState,\r\n        addPopstateListener: addPopstateListener,\r\n        getLocation: getLocation,\r\n        getState: getState,\r\n        getHash: getHash\r\n    };\r\n}\r\nelse {\r\n    browser = {\r\n        getBase: value(''),\r\n        pushState: noop,\r\n        replaceState: noop,\r\n        addPopstateListener: noop,\r\n        getLocation: value(''),\r\n        getState: value(null),\r\n        getHash: value('')\r\n    };\r\n}\r\nvar safeBrowser = browser;\n\nvar defaultOptions = {\r\n    forceDeactivate: true,\r\n    useHash: false,\r\n    hashPrefix: '',\r\n    base: '',\r\n    mergeState: false,\r\n    preserveHash: true\r\n};\r\nvar source = 'popstate';\r\nfunction browserPluginFactory(opts, browser) {\r\n    if (browser === void 0) { browser = safeBrowser; }\r\n    var options = __assign({}, defaultOptions, opts);\r\n    var transitionOptions = {\r\n        forceDeactivate: options.forceDeactivate,\r\n        source: source\r\n    };\r\n    var removePopStateListener;\r\n    return function browserPlugin(router) {\r\n        var routerOptions = router.getOptions();\r\n        var routerStart = router.start;\r\n        router.buildUrl = function (route, params) {\r\n            var base = options.base || '';\r\n            var prefix = options.useHash ? \"#\" + options.hashPrefix : '';\r\n            var path = router.buildPath(route, params);\r\n            if (path === null)\r\n                return null;\r\n            return base + prefix + path;\r\n        };\r\n        var urlToPath = function (url) {\r\n            var match = url.match(/^(?:http|https):\\/\\/(?:[0-9a-z_\\-.:]+?)(?=\\/)(.*)$/);\r\n            var path = match ? match[1] : url;\r\n            var pathParts = path.match(/^(.+?)(#.+?)?(\\?.+)?$/);\r\n            if (!pathParts)\r\n                throw new Error(\"[router5] Could not parse url \" + url);\r\n            var pathname = pathParts[1];\r\n            var hash = pathParts[2] || '';\r\n            var search = pathParts[3] || '';\r\n            return ((options.useHash\r\n                ? hash.replace(new RegExp('^#' + options.hashPrefix), '')\r\n                : options.base\r\n                    ? pathname.replace(new RegExp('^' + options.base), '')\r\n                    : pathname) + search);\r\n        };\r\n        router.matchUrl = function (url) { return router.matchPath(urlToPath(url)); };\r\n        router.start = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            if (args.length === 0 || typeof args[0] === 'function') {\r\n                routerStart.apply(void 0, [browser.getLocation(options)].concat(args));\r\n            }\r\n            else {\r\n                routerStart.apply(void 0, args);\r\n            }\r\n            return router;\r\n        };\r\n        router.replaceHistoryState = function (name, params, title) {\r\n            if (params === void 0) { params = {}; }\r\n            if (title === void 0) { title = ''; }\r\n            var route = router.buildState(name, params);\r\n            var state = router.makeState(route.name, route.params, router.buildPath(route.name, route.params), { params: route.meta });\r\n            var url = router.buildUrl(name, params);\r\n            router.lastKnownState = state;\r\n            browser.replaceState(state, title, url);\r\n        };\r\n        function updateBrowserState(state, url, replace) {\r\n            var trimmedState = state\r\n                ? {\r\n                    meta: state.meta,\r\n                    name: state.name,\r\n                    params: state.params,\r\n                    path: state.path\r\n                }\r\n                : state;\r\n            var finalState = options.mergeState === true\r\n                ? __assign({}, browser.getState(), trimmedState) : trimmedState;\r\n            if (replace)\r\n                browser.replaceState(finalState, '', url);\r\n            else\r\n                browser.pushState(finalState, '', url);\r\n        }\r\n        function onPopState(evt) {\r\n            var routerState = router.getState();\r\n            // Do nothing if no state or if last know state is poped state (it should never happen)\r\n            var newState = !evt.state || !evt.state.name;\r\n            var state = newState\r\n                ? router.matchPath(browser.getLocation(options), source)\r\n                : router.makeState(evt.state.name, evt.state.params, evt.state.path, __assign({}, evt.state.meta, { source: source }), evt.state.meta.id);\r\n            var defaultRoute = routerOptions.defaultRoute, defaultParams = routerOptions.defaultParams;\r\n            if (!state) {\r\n                // If current state is already the default route, we will have a double entry\r\n                // Navigating back and forth will emit SAME_STATES error\r\n                defaultRoute &&\r\n                    router.navigateToDefault(__assign({}, transitionOptions, { reload: true, replace: true }));\r\n                return;\r\n            }\r\n            if (routerState &&\r\n                router.areStatesEqual(state, routerState, false)) {\r\n                return;\r\n            }\r\n            router.transitionToState(state, routerState, transitionOptions, function (err, toState) {\r\n                if (err) {\r\n                    if (err.redirect) {\r\n                        var _a = err.redirect, name_1 = _a.name, params = _a.params;\r\n                        router.navigate(name_1, params, __assign({}, transitionOptions, { replace: true, force: true, redirected: true }));\r\n                    }\r\n                    else if (err.code === errorCodes.CANNOT_DEACTIVATE) {\r\n                        var url = router.buildUrl(routerState.name, routerState.params);\r\n                        if (!newState) {\r\n                            // Keep history state unchanged but use current URL\r\n                            updateBrowserState(state, url, true);\r\n                        }\r\n                        // else do nothing or history will be messed up\r\n                        // TODO: history.back()?\r\n                    }\r\n                    else {\r\n                        // Force navigation to default state\r\n                        defaultRoute &&\r\n                            router.navigate(defaultRoute, defaultParams, __assign({}, transitionOptions, { reload: true, replace: true }));\r\n                    }\r\n                }\r\n                else {\r\n                    router.invokeEventListeners(constants.TRANSITION_SUCCESS, toState, routerState, { replace: true });\r\n                }\r\n            });\r\n        }\r\n        function onStart() {\r\n            if (options.useHash && !options.base) {\r\n                // Guess base\r\n                options.base = browser.getBase();\r\n            }\r\n            removePopStateListener = browser.addPopstateListener(onPopState, options);\r\n        }\r\n        function teardown() {\r\n            if (removePopStateListener) {\r\n                removePopStateListener();\r\n                removePopStateListener = undefined;\r\n            }\r\n        }\r\n        function onTransitionSuccess(toState, fromState, opts) {\r\n            var historyState = browser.getState();\r\n            var hasState = historyState &&\r\n                historyState.meta &&\r\n                historyState.name &&\r\n                historyState.params;\r\n            var statesAreEqual = fromState && router.areStatesEqual(fromState, toState, false);\r\n            var replace = opts.replace || !hasState || statesAreEqual;\r\n            var url = router.buildUrl(toState.name, toState.params);\r\n            if (fromState === null &&\r\n                options.useHash === false &&\r\n                options.preserveHash === true) {\r\n                url += browser.getHash();\r\n            }\r\n            updateBrowserState(toState, url, replace);\r\n        }\r\n        return {\r\n            onStart: onStart,\r\n            onStop: teardown,\r\n            teardown: teardown,\r\n            onTransitionSuccess: onTransitionSuccess,\r\n            onPopState: onPopState\r\n        };\r\n    };\r\n}\n\nexport default browserPluginFactory;\n","import { useState, useMemo } from \"haunted-w-microtask\";\nimport { useDisconnected } from \"./use-disconnected\";\nimport { useTriggerUpdate } from \"./use-trigger-update\";\n\nimport createRouter from 'router5'\nimport browserPlugin from 'router5-plugin-browser'\n\n// router5 doesn't want lots of individual instances, so use a singleton\nconst router = createRouter([{name: 'default', path: '*route'}])\nrouter.usePlugin(browserPlugin({\n  useHash: true\n}));\nrouter.start();\n\nexport function useRouter(options): any {\n  const [timesDisconnected, setTimesDisconnected] = useState(0);\n  const triggerUpdate = useTriggerUpdate();\n\n  const routerApi = useMemo(function() {\n    \n    let route = \"\"; // the current partial route that this component cares about\n\n    // router5 passes state into the handler with no hash.  \n    // If default route is defined with it, we need to add it back when processing\n    let useHash = options.defaultRoute[0] === '#';\n\n    const handler = (routerState): void => {\n      let _route = routerState.route.path;\n\n      // If a defined route matches the current route, use it.\n      if (options.routes[_route.replace(options.baseRoute, '')] ||\n          options.routes[('#'+_route).replace(options.baseRoute, '')]) {\n        route = _route\n        triggerUpdate();\n        return;\n      }\n      \n      // If a defined route is a base for the current route, do return the base.\n      // This is for parent routers to relax and be okay with what their kids are doing.\n      const partialPath = Object.keys(options.routes).reduce((out, routePath) => {\n        return _route.indexOf(routePath) === 0 ||\n               ('#'+_route).indexOf(routePath) === 0 ? routePath : out;\n      }, \"\");      \n      if (partialPath) {\n        route = partialPath;\n        triggerUpdate();\n        return;\n      }\n\n      // At this point, if this our baseRoute matches the currentRoute, it means \n      // the current route is invalid and we should handle it by redirecting to our default route.\n      if (_route.indexOf(options.baseRoute) === 0 ||\n          ('#'+_route).indexOf(options.baseRoute) === 0) {\n        route = options.baseRoute + options.defaultRoute;        \n        triggerUpdate();\n        //router.navigate(route, {}, {replace:true});\n        window.location.hash = route;\n      }\n    }\n\n    //subscribe to future changes\n    const routerUnsubscribe = router.subscribe(handler);\n    \n    //invoke the handler for the current route\n    handler({\n      route: router.getState()\n    });\n\n    //return methods to be invoked elsewhere\n    return {\n      getRoute : () => {\n        // TODO: currently having to do some gymnastics to manage where '#' should be returned\n        let tempRoute = route;\n        if (tempRoute[0] !== '#' && options.baseRoute[0] === '#') {\n          tempRoute = '#'+tempRoute;\n        } else if (useHash && tempRoute[0] !== '#') {\n          tempRoute = '#'+tempRoute;\n        }\n        return tempRoute.replace(options.baseRoute, '')\n      },\n      unsubscribe: routerUnsubscribe\n    };\n\n    // using timesDisconnected as a memo is one way to manage subscribing/unsubscribing\n  }, [timesDisconnected]); \n\n  useDisconnected(() => {\n    routerApi.unsubscribe();\n    setTimesDisconnected(timesDisconnected + 1);\n  });\n  \n  return routerApi.getRoute(); //return the valid partial route that the component will care about\n};\n","/* eslint-disable */\n\nimport { component, html } from \"haunted-w-microtask\";\n\nimport { useRouter } from './use-router';\n\nconst routes = {\n    \"/child-route-A\": html`<h2>I am child 1 route A</h2>`,\n    \"/child-route-B\": html`<h2>I am child 1 route B</h2>`\n};\n\nfunction ChildOne({baseRoute}) {\n  const route = useRouter({\n    id: \"childRouter\",\n    routes: routes,\n    defaultRoute: \"/child-route-A\",\n    baseRoute: baseRoute\n  });\n\n  return !route ? html`` : html`\n    <h1>I am child 1.  I have a child router</h1>\n\n    <a href=\"${baseRoute}/child-route-A\">Go to child route A</a>\n    <a href=\"${baseRoute}/child-route-B\">Go to child route B</a>\n\n    ${routes[route]}\n  `;\n}\n\nChildOne.observedAttributes = ['base-route'];\n\ncustomElements.define(\n  \"child-one\",\n  component(ChildOne, HTMLElement, {\n    useShadowDOM: false\n  })\n);\n","/* eslint-disable */\n\nimport { component, html } from \"haunted-w-microtask\";\n\nfunction ChildTwo(el) {\n  return html`\n    <h1>I am child 2. I don't have a child router</h1>\n  `;\n}\n\ncustomElements.define(\n  \"child-two\",\n  component(ChildTwo, HTMLElement, {\n    useShadowDOM: false\n  })\n);\n","/* eslint-disable */\n\nimport { component, html } from \"haunted-w-microtask\";\nimport \"./router-test.scss\";\nimport { useRouter } from './use-router';\n\nimport \"./child-one\";\nimport \"./child-two\"\n\nconst routes = {\n    \"#/route1\": html`<child-one base-route=\"#/route1\"></child-one>`,\n    \"#/route2\": html`<child-two base-route=\"#/route2\"></child-two>`\n};\n\nfunction RouterTest(el) {\n\n  const route = useRouter({\n    id: \"parentRouter\",\n    routes: routes,\n    defaultRoute: \"#/route1\",\n    baseRoute: \"\"\n  });\n\n  return !route ? html`` : html`\n    <h1>Element with router</h1>\n\n    <a href=\"#/route1\">Go To Child 1</a>\n    <a href=\"#/route2\">Go To Child 2</a>\n\n    <main>\n      ${routes[route]}\n    </main>\n  `;\n}\n\ncustomElements.define(\n  \"router-test\",\n  component(RouterTest, HTMLElement, {\n    useShadowDOM: false\n  })\n);\n"]}